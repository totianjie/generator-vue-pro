webpackJsonp([18],{"5L5V":function(e,t){},Q2xd:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r("woOf"),a=r.n(o),i=r("QmSG"),l=r("mvHQ"),n=r.n(l),s=r("wrBq"),d={props:{tableData:{type:Array,default:function(){return[]}}},data:function(){return{testResult:"",currentRoleData:"",currentRoleGroupData:"",selectedRoleGroup:-1,showTreeRoleGourp:!1,selectedRole:-1,roleGroupId:"",roleId:"",tableSize:i.a.tableSize,colWidth:i.a.colWidth}},computed:{},watch:{},created:function(){},methods:{updateSelect:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=0;this.tableData.forEach(function(t,r){t.id===e&&(o=r)}),this.currentSelectGroupIndex=o,null!==t&&void 0!==t?(this.selectedRole=t,this.selectedRoleGroup=-1):this.selectedRoleGroup=e,r||(this.showTreeRoleGourp=!0),this.requestRoleList(e)},requestRoleList:function(e){var t=this;Object(s.i)({id:e}).then(function(r){t.roleGroupId=e;var o=r.data;t.tableData.forEach(function(r,a){t.tableData[a].children=[],r.id===e&&(t.roleGroupName=r.name,o.forEach(function(o){o.groupIndex_=a,o.roleGroupId=e,o.roleGroupName=r.name,t.tableData[a].children.push(o)}))}),t.tableData=t.tableData.concat([])}).catch(function(e){})},refreshTableView:function(){this.selectedRoleGroup=-1,this.selectedRole=-1,this.currentSelectGroupIndex=-1,this.showTreeRoleGourp=!1},editInfo:function(){var e=this;-1!==this.selectedRole||-1!==this.selectedRoleGroup?-1!==this.selectedRole?this.$emit("editRole",JSON.parse(n()(this.currentRoleData))):(this.tableData.forEach(function(t){t.id===e.selectedRoleGroup&&(e.currentRoleGroupData=t)}),this.$emit("editRoleGroup",JSON.parse(n()(this.currentRoleGroupData)))):this.$toast("请选择后在编辑")},delItem:function(){var e=this;-1!==this.selectedRole||-1!==this.selectedRoleGroup?-1!==this.selectedRole?this._$confirm().then(function(){Object(s.e)({id:e.selectedRole}).then(function(t){e.$emit("delRole",e.currentRoleData),e.selectedRoleGroup=-1,e.selectedRole=-1,e.currentSelectGroupIndex=-1,e.showTreeRoleGourp=!1})}).catch(function(e){}):this._$confirm().then(function(){Object(s.f)({id:e.selectedRoleGroup}).then(function(t){e.$emit("delRoleGroup",e.currentRoleGroupData),e.selectedRoleGroup=-1,e.selectedRole=-1,e.currentSelectGroupIndex=-1,e.showTreeRoleGourp=!1})}).catch(function(e){}):this.$toast("请选择后在删除")},addRole:function(e){this.$emit("createRole",e)},addGroup:function(){this.selectedRoleGroup=-1,this.selectedRole=-1,this.currentSelectGroupIndex=-1,this.showTreeRoleGourp=!1,this.$emit("createRoleGroup",null)},selectRoleGroupItem:function(e){var t=this;try{if(this.currentRoleGroupData=e,this.currentRoleData="",e.isRoleGroup)try{if(this.currentSelectGroupIndex===e.groupIndex_&&this.showTreeRoleGourp)return this.showTreeRoleGourp=!1,this.selectedRoleGroup=e.id,this.selectedRole=-1,this.roleGroupName=e.name,this.roleGroupId=e.isRoleGroup?e.id:"",this.roleId="",void this.$emit("detailRoleGroup",e);this.currentSelectGroupIndex=e.groupIndex_,this.showTreeRoleGourp=!0;var r=e.name;this.addRoleForm={name_:r,name:"",menus:[],remark:""},this.roleGroupId=e.isRoleGroup?e.id:"",this.$emit("detailRoleGroup",e),this.roleGroupName=e.name,this.selectedRoleGroup=e.id,this.selectedRole=-1,Object(s.i)({id:e.id}).then(function(r){t.roleGroupId=e.id,t.roleGroupName=e.name;var o=r.data;t.tableData.forEach(function(r,a){t.tableData[a].children=[],r.id===e.id&&o.forEach(function(r){r.groupIndex_=e.groupIndex_,r.roleGroupId=e.id,r.roleGroupName=e.name,t.tableData[a].children.push(r)})}),t.tableData=t.tableData.concat([])}).catch(function(e){})}catch(e){}}catch(e){}},selectRole:function(e,t){this.testResult=e,this.selectedRole=e.id,this.selectedRoleGroup=-1,this.currentRoleData=e,this.currentSelectGroupIndex=e.groupIndex_,this.showTreeRoleGourp=!0,this.currentRoleGroupData="",this.$emit("detailRole",e)}},filters:{},components:{}},u={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"btn-wrap"},[r("el-button",{attrs:{size:"small",plain:"",icon:"iconfont icon-xinjian-weidianji"},on:{click:e.addGroup}},[r("span",{staticClass:"text"},[e._v("新增组")])]),e._v(" "),r("el-button",{attrs:{size:"small",plain:"",icon:"iconfont icon-xiugai-weidianji"},on:{click:e.editInfo}},[r("span",{staticClass:"text"},[e._v("编辑")])]),e._v(" "),r("el-button",{attrs:{size:"small",plain:"",icon:"iconfont icon-shanchu-weidianji"},on:{click:e.delItem}},[r("span",{staticClass:"text"},[e._v("删除")])])],1),e._v(" "),r("div",{staticClass:"role-wrap"},[e.tableData.length>0?r("ul",{staticClass:"tree"},e._l(e.tableData,function(t,o){return r("li",{key:o,staticClass:"item"},[r("div",{class:["text text-ellipsis",{active:e.selectedRoleGroup==t.id}]},[e.currentSelectGroupIndex==o&&e.showTreeRoleGourp?r("i",{staticClass:"el-icon-caret-bottom",class:["icontext",{active:e.selectedRoleGroup==t.id}],on:{click:function(r){return e.selectRoleGroupItem(t)}}}):r("i",{staticClass:"el-icon-caret-right",class:["icontext",{active:e.selectedRoleGroup==t.id}],on:{click:function(r){return e.selectRoleGroupItem(t)}}}),e._v(" "),r("el-tooltip",{directives:[{name:"show",rawName:"v-show",value:t.name.length>10,expression:"item.name.length>10"}],attrs:{content:t.name,placement:"bottom"}},[r("span",{staticClass:"name",class:["roleGroupName",{active:e.selectedRoleGroup==t.id}],on:{click:function(r){return e.selectRoleGroupItem(t)}}},[e._v(e._s(t.name))])]),e._v(" "),r("span",{directives:[{name:"show",rawName:"v-show",value:t.name.length<11,expression:"item.name.length<11"}],staticClass:"name",class:["roleGroupName",{active:e.selectedRoleGroup==t.id}],on:{click:function(r){return e.selectRoleGroupItem(t)}}},[e._v(e._s(t.name))]),e._v(" "),r("el-tooltip",{attrs:{content:"新增角色",placement:"bottom-start"}},[r("i",{staticClass:"el-icon-circle-plus add-icon iconfont icon-xinjianjiaoseanniu-weidianji addRoleBtn",on:{click:function(r){return r.stopPropagation(),e.addRole(t)}}})])],1),e._v(" "),t.hasOwnProperty("children")&&Array.isArray(t.children)?r("ul",{directives:[{name:"show",rawName:"v-show",value:e.showTreeRoleGourp,expression:"showTreeRoleGourp"}],key:"child_"+o,staticClass:"tree-text"},e._l(t.children,function(o,a){return r("li",{key:"child_list"+a,staticClass:"item"},[r("el-tooltip",{directives:[{name:"show",rawName:"v-show",value:o.name.length>10,expression:"childrenitem.name.length>10"}],attrs:{content:o.name,placement:"bottom"}},[r("div",{staticClass:"text text-ellipsis",class:["roleName",{active:e.selectedRole==o.id}],on:{click:function(r){return e.selectRole(o,t)}}},[e._v("\n                                "+e._s(o.name)+"\n                            ")])]),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:o.name.length<11,expression:"childrenitem.name.length<11"}],staticClass:"text text-ellipsis",class:["roleName",{active:e.selectedRole==o.id}],on:{click:function(r){return e.selectRole(o,t)}}},[e._v("\n                            "+e._s(o.name)+"\n                        ")])],1)}),0):e._e()])}),0):e._e()])])},staticRenderFns:[]};var c=r("VU/8")(d,u,!1,function(e){r("wV4v")},"data-v-0ec690d4",null).exports,p=r("Gu7T"),h=r.n(p),m=(r("pFYg"),r("IVM2")),f={name:[{required:!0,trigger:"blur",validator:function(e,t,r){try{if("string"!=typeof t)return r(new Error("请输入角色名称"));if(!t.length)return r(new Error("请输入角色名称"));var o=m.a.text.test(t),a=t.length<2||t.length>20;if(!o)return r(new Error("您输入不正确(须中文输入， 2~20 位字符)"));if(a)return r(new Error("您输入不正确(须中文输入， 2~20 位字符)"));r()}catch(e){}}}],remark:[{validator:function(e,t,r){try{return"string"!=typeof t?r():t.length&&t.length>200?r(new Error("您输入不正确(限制 200 字符)")):r()}catch(e){return r()}},trigger:"blur"}]},R={data:function(){var e=this;return{otherInfos:[],selectRole:!1,defaultProps:{children:"children",label:"name"},bSing:!1,treeShow:!1,isSelectGroupRole:!1,addRoleForm:{id:"",name:"",menus:[],code:"",remark:"",enable:"",name_:"",roleGroupId:"",parentId:"",roleGroupCode:"",roleGroupName:""},item:{id:"",name:"",code:""},roleGroupMenus:[],roleTree:[],rules:a()({},f,{menus:[{trigger:"change",validator:function(t,r,o){return e.getCheckedArr().length<=0?o(new Error("请选择角色授权")):o()},required:!0}],roleGroupId:[{trigger:"change",required:!0,validator:function(e,t,r){return r()}}],name:[{required:!0,trigger:"blur",validator:function(t,r,o){try{if("string"!=typeof r)return o(new Error("请输入角色名称"));if(!r.length)return o(new Error("请输入角色名称"));var a=/^[\u4e00-\u9fa5]+$/.test(r),i=r.length<2||r.length>20;if(!a)return o(new Error("您输入不正确(须中文输入，2~20位字符)"));if(i)return o(new Error("您输入不正确(须中文输入，2~20位字符)"));Object(s.c)({name:r,id:e.id,groupId:e.groupId}).then(function(e){if(e.data){if("请求成功"!==e.data.errorMsg)return void o(new Error(e.data.errorMsg))}else if("请求成功"!==e.errorMsg)return void o(new Error(e.errorMsg));o()}).catch(function(e){e.data?o(new Error(e.data.errorMsg)):o(new Error(e.errorMsg))})}catch(e){return o(new Error("您输入不正确(须中文输入，2~20位字符)"))}}}]})}},computed:{},props:{id:{type:Number,default:function(){return-1}},groupId:{type:Number,default:function(){return-1}},roleGroupDetail:{type:Object,default:function(){return{}}},isEdit:{type:Boolean,default:function(){return!1}},tableData:{type:Array,default:function(){return[]}}},mounted:function(){},created:function(){this._getData()},watch:{id:function(e,t){this._getData()},roleGroupDetail:function(e){this.item.id=this.roleGroupDetail.roleGroupId,this.item.code=this.roleGroupDetail.roleGroupCode,this.item.name=this.roleGroupDetail.roleGroupName}},methods:{addRoleHandleClick:function(e,t){this.addRoleForm.menus=t.checkedNodes},_getGroupData:function(e){var t=this;this.addRoleForm.id=this.id,Object(s.k)({id:e}).then(function(e){t.roleGroupMenus=e.data,t.roleTree=e.data,t.isEdit&&Object(s.o)({id:t.addRoleForm.id}).then(function(e){t.otherInfos=e.data,t.otherInfos.forEach(function(e){e.hasOwnProperty("children")&&(t.otherInfos=[].concat(h()(t.otherInfos),h()(e.children)),e.children=[])}),t.otherInfos.forEach(function(e){e.hasOwnProperty("children")&&(t.otherInfos=[].concat(h()(t.otherInfos),h()(e.children)),e.children=[])}),t.otherInfos.forEach(function(e){e.hasOwnProperty("children")&&(t.otherInfos=[].concat(h()(t.otherInfos),h()(e.children)),e.children=[])}),t.$refs.tree.setCheckedNodes(t.otherInfos.filter(function(e){return"2"===e.mark}))}).catch(function(e){})}).catch(function(e){})},changeGroupRole:function(e){var t=this;try{this.addRoleForm.roleGroupId=e,this.tableData.forEach(function(r){r.id===e&&(t.addRoleForm.roleGroupName=r.name,t.addRoleForm.roleGroupCode=r.code)}),this.isSelectGroupRole=!0,this._getGroupData(e)}catch(e){}},getCheckedArr:function(){var e=this.$refs.tree.getCheckedNodes();e.forEach(function(e){e.mark="2"});var t=this.$refs.tree.getHalfCheckedNodes();return t.forEach(function(e){e.mark="1"}),e.concat(t)},_getData:function(){var e=this;if(-1!==this.id)Object(s.j)({id:this.id}).then(function(t){if(e.addRoleForm=t.data,e.addRoleForm.menus=[],e.roleGroupDetail){var r=JSON.parse(n()(e.roleGroupDetail));e.addRoleForm.roleGroupName=r.roleGroupName,e.addRoleForm.roleGroupId=r.roleGroupId,e.item.id=r.roleGroupId,e.item.name=r.roleGroupName,e.item.code=r.roleGroupCode}}).catch(function(e){}),this._getGroupData(this.groupId),this.isEdit&&Object(s.o)({id:this.id}).then(function(t){e.otherInfos=t.data,e.otherInfos.forEach(function(t){t.hasOwnProperty("children")&&(e.otherInfos=[].concat(h()(e.otherInfos),h()(t.children)),t.children=[])}),e.otherInfos.forEach(function(t){t.hasOwnProperty("children")&&(e.otherInfos=[].concat(h()(e.otherInfos),h()(t.children)),t.children=[])}),e.otherInfos.forEach(function(t){t.hasOwnProperty("children")&&(e.otherInfos=[].concat(h()(e.otherInfos),h()(t.children)),t.children=[])}),e.otherInfos=e.otherInfos.filter(function(e){return"2"===e.mark}),e.$refs.tree.setCheckedNodes(e.otherInfos.filter(function(e){return"2"===e.mark}))}).catch(function(e){});else if(this.roleGroupDetail){var t=JSON.parse(n()(this.roleGroupDetail));this.addRoleForm.roleGroupName=t.roleGroupName,this.addRoleForm.roleGroupId=t.roleGroupId,this.item.id=t.roleGroupId,this.item.name=t.roleGroupName,this.item.code=t.roleGroupCode,this.addRoleForm.menus=[]}},cancelBtn:function(e){this.$emit("input",!1),this.$emit("update",{id:e.id,isRoleGroup:!1,cancel:!0,groupId:this.addRoleForm.roleGroupId})},submitBtn:function(){var e=this;this.selectRole=!0,this.$refs.addRoleForm.validate(function(t){return!!t&&(!(e.getCheckedArr().length<=0)&&(e.addRoleForm.menus=e.getCheckedArr(),void(e.isEdit?Object(s.g)(e.addRoleForm).then(function(t){if(e.$emit("input",!1),e.addRoleForm.name!==e.roleGroupDetail.roleName){var r=e.roleGroupDetail.roleName;e.$emit("update",{id:e.id,roleId:e.id,isRoleGroup:!1,groupId:e.roleGroupDetail.roleGroupId}),e.$emit("updateRoleName",{id:e.id,roleOldName:r,roleNewName:e.addRoleForm.name,roleGroupId:e.roleGroupDetail.roleGroupId,roleRemark:e.addRoleForm.remark||"",roleGroupName:e.roleGroupDetail.roleGroupName})}else e.$emit("update",{id:e.id,roleId:e.id,isRoleGroup:!1,groupId:e.roleGroupDetail.roleGroupId})}).catch(function(e){}):Object(s.d)(e.addRoleForm).then(function(t){e.$emit("input",!1),e.$emit("update",{id:t.data,roleId:t.data,isRoleGroup:!1,groupId:e.roleGroupDetail.roleGroupId})}).catch(function(e){}))))})}}},G={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"add-role-group-wrap role-height",on:{click:function(t){e.treeShow=!1}}},[r("el-col",{attrs:{span:15}},[r("el-form",{ref:"addRoleForm",attrs:{model:e.addRoleForm,rules:e.rules,"label-width":"110px"}},[r("el-form-item",{attrs:{label:"角色名称：",prop:"name"}},[r("el-input",{attrs:{placeholder:"请输入角色名称"},model:{value:e.addRoleForm.name,callback:function(t){e.$set(e.addRoleForm,"name",t)},expression:"addRoleForm.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"所属角色组：",prop:"roleGroupId"}},[r("el-select",{staticClass:"w-fill",attrs:{placeholder:"请选择角色组",disabled:"true"},on:{change:function(t){return e.changeGroupRole(t,e.item)}},model:{value:e.item.id,callback:function(t){e.$set(e.item,"id",t)},expression:"item.id"}},e._l(e.tableData,function(e){return r("el-option",{key:e.id,attrs:{value:e.id,label:e.name}})}),1)],1),e._v(" "),r("el-form-item",{staticStyle:{position:"relative"},attrs:{label:"角色授权：",prop:"menus"}},[r("el-tree",{ref:"tree",staticClass:"dataTree",attrs:{"empty-text":"暂无数据...","expand-on-click-node":!1,data:e.roleTree,props:e.defaultProps,"node-key":"id","show-checkbox":""},on:{check:e.addRoleHandleClick},model:{value:e.addRoleForm.menus,callback:function(t){e.$set(e.addRoleForm,"menus",t)},expression:"addRoleForm.menus"}}),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.addRoleForm.menus.length&&e.selectRole,expression:"addRoleForm.menus.length&&selectRole"}],staticClass:"el-form-item__error"},[e._v("请选择角色授权")])],1),e._v(" "),r("el-form-item",{attrs:{label:"备注：",prop:"remark"}},[r("el-input",{attrs:{rows:3,type:"textarea",autosize:"",placeholder:"在此添加备注",maxlength:"200"},model:{value:e.addRoleForm.remark,callback:function(t){e.$set(e.addRoleForm,"remark",t)},expression:"addRoleForm.remark"}})],1),e._v(" "),r("el-form-item",{staticClass:"btn"},[r("el-button",{on:{click:function(t){return e.cancelBtn(e.addRoleForm)}}},[e._v("取消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.submitBtn}},[e._v("确定")])],1)],1)],1)],1)},staticRenderFns:[]};var v=r("VU/8")(R,G,!1,function(e){r("aVTy")},"data-v-7aefb28e",null).exports,g={name:[{required:!0,trigger:"blur",validator:function(e,t,r){try{if("string"!=typeof t)return r(new Error("请输入角色组名称"));if(!t.length)return r(new Error("请输入角色组名称"));var o=m.a.text.test(t),a=t.length<2||t.length>20;if(!o)return r(new Error("您输入不正确(须中文输入， 2~20 位字符)"));if(a)return r(new Error("您输入不正确(须中文输入， 2~20 位字符)"));r()}catch(e){}}}],remark:[{validator:function(e,t,r){try{return"string"!=typeof t?r():t.length&&t.length>200?r(new Error("您输入不正确(限制 200 字符)")):r()}catch(e){return r()}},trigger:"blur"}]},b={data:function(){var e=this;return{keepData:{},otherInfos:[],selectRole:!1,defaultProps:{children:"children",label:"name"},bSing:!1,treeShow:!1,addRoleGroupForm:{id:"",name:"",menus:[],code:"",remark:"",enable:"",name_:"",roleGroupId:"",parentId:""},roleGroupTree:[],rules:a()({},g,{menus:[{trigger:"change",validator:function(t,r,o){return e.getCheckedArr().length<=0?o(new Error("请选择角色组授权")):o()},required:!0}],name:[{required:!0,trigger:"blur",validator:function(t,r,o){try{if("string"!=typeof r)return o(new Error("请输入角色组名称"));if(!r.length)return o(new Error("请输入角色组名称"));var a=/^[\u4e00-\u9fa5]+$/.test(r),i=r.length<2||r.length>20;if(!a)return o(new Error("您输入不正确(须中文输入，2~20位字符)"));if(i)return o(new Error("您输入不正确(须中文输入，2~20位字符)"));Object(s.b)({name:r,id:e.id}).then(function(e){if(e.data){if("请求成功"!==e.data.errorMsg)return void o(new Error(e.data.errorMsg))}else if("请求成功"!==e.errorMsg)return void o(new Error(e.errorMsg));o()}).catch(function(e){e.data?o(new Error(e.data.errorMsg)):o(new Error(e.errorMsg))})}catch(e){return o(new Error("您输入不正确(须中文输入，2~20位字符)"))}}}]})}},computed:{},props:{id:{type:Number,default:function(){return-1}},isEdit:{type:Boolean,default:function(){return!1}}},mounted:function(){},created:function(){this._getData()},methods:{getCheckedArr:function(){var e=this.$refs.tree.getCheckedNodes();e.forEach(function(e){e.mark="2"});var t=this.$refs.tree.getHalfCheckedNodes();return t.forEach(function(e){e.mark="1"}),e.concat(t)},addRoleGroupHandleClick:function(e,t){this.addRoleGroupForm.menus=t.checkedNodes},_getData:function(){var e=this;Object(s.n)().then(function(t){e.roleGroupTree=t.data,e.id&&e._roleGroupDetail(e.id)}).catch(function(e){})},_roleGroupDetail:function(e){var t=this;-1!==e&&Object(s.l)({id:e}).then(function(r){t.addRoleGroupForm=r.data,t.keepData=JSON.parse(n()(r.data)),t.addRoleGroupForm.menus=[],Object(s.k)({id:e}).then(function(e){t.otherInfos=e.data,t.otherInfos.forEach(function(e){e.hasOwnProperty("children")&&(t.otherInfos=[].concat(h()(t.otherInfos),h()(e.children)),e.children=[])}),t.otherInfos.forEach(function(e){e.hasOwnProperty("children")&&(t.otherInfos=[].concat(h()(t.otherInfos),h()(e.children)),e.children=[])}),t.otherInfos.forEach(function(e){e.hasOwnProperty("children")&&(t.otherInfos=[].concat(h()(t.otherInfos),h()(e.children)),e.children=[])}),t.$refs.tree.setCheckedNodes(t.otherInfos.filter(function(e){return"2"===e.mark}))}).catch(function(e){})}).catch(function(e){})},cancelBtn:function(e){this.$emit("input",!1),this.$emit("update",{id:e.id,isRoleGroup:!0,cancel:!0})},submitBtn:function(){var e=this;this.selectRole=!0,this.$refs.addRoleGroupForm.validate(function(t){return!!t&&(!((e.getCheckedArr()||[]).length<=0)&&(e.addRoleGroupForm.menus=e.getCheckedArr(),void(e.isEdit?Object(s.h)(e.addRoleGroupForm).then(function(t){e.$emit("input",!1),e.keepData.name!==e.addRoleGroupForm.name?(e.$emit("update",{id:e.id,isRoleGroup:!0,groupId:e.id}),e.$emit("updateGroupName",{id:e.id,newGroupName:e.addRoleGroupForm.name,oldGroupName:e.keepData.name})):e.$emit("update",{id:e.id,isRoleGroup:!0,groupId:e.id})}):Object(s.a)(e.addRoleGroupForm).then(function(t){e.$emit("input",!1),e.$emit("update",{id:t.data,isRoleGroup:!0,groupId:t.data})}).catch(function(e){}))))})}}},I={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"add-role-group-wrap role-height",on:{click:function(t){e.treeShow=!1}}},[r("el-col",{attrs:{span:15}},[r("el-form",{ref:"addRoleGroupForm",attrs:{model:e.addRoleGroupForm,rules:e.rules,"label-width":"110px"}},[r("el-form-item",{attrs:{label:"角色组名称：",prop:"name"}},[r("el-input",{attrs:{placeholder:"请输入角色组名称"},model:{value:e.addRoleGroupForm.name,callback:function(t){e.$set(e.addRoleGroupForm,"name",t)},expression:"addRoleGroupForm.name"}})],1),e._v(" "),r("el-form-item",{staticStyle:{position:"relative"},attrs:{label:"角色组授权：",prop:"menus"}},[r("el-tree",{ref:"tree",staticClass:"dataTree",attrs:{"empty-text":"暂无数据...","expand-on-click-node":!1,data:e.roleGroupTree,props:e.defaultProps,"node-key":"id","show-checkbox":""},on:{check:e.addRoleGroupHandleClick},model:{value:e.addRoleGroupForm.menus,callback:function(t){e.$set(e.addRoleGroupForm,"menus",t)},expression:"addRoleGroupForm.menus"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"备注：",prop:"remark"}},[r("el-input",{attrs:{rows:3,type:"textarea",autosize:"",maxlength:"200",placeholder:"在此添加备注"},model:{value:e.addRoleGroupForm.remark,callback:function(t){e.$set(e.addRoleGroupForm,"remark",t)},expression:"addRoleGroupForm.remark"}})],1),e._v(" "),r("el-form-item",{staticClass:"btn"},[r("el-button",{on:{click:function(t){return e.cancelBtn(e.addRoleGroupForm)}}},[e._v("取消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.submitBtn}},[e._v("确定")])],1)],1)],1)],1)},staticRenderFns:[]};var _=r("VU/8")(b,I,!1,function(e){r("dbke")},"data-v-1acfe039",null).exports,w={data:function(){return{span:8,bSing:!1,btnSize:i.a.baseBtn,detailRoleForm:{id:"",name:"",menus:[],code:"",remark:"",enable:"",name_:"",roleGroupId:"",parentId:""},roleGroupTree:[],defaultProps:{children:"children",label:"name"},roleTree:[]}},props:{id:{type:Number,default:function(){return-1}},tableData:{type:Array,default:function(){return[]}}},created:function(){this.bSing=!0,this._getData()},mounted:function(){},methods:{_getData:function(){var e=this;try{if(-1===this.id){try{throw new Error("异常数据")}catch(e){}return}}catch(e){}try{Object(s.j)({id:this.id}).then(function(t){e.detailRoleForm={},t.data.createTime=e.formatDateTime(t.data.createTime),e.detailRoleForm=t.data}).catch(function(e){})}catch(e){}try{Object(s.o)({id:this.id}).then(function(t){e.roleTree=[],e.roleTree=t.data}).catch(function(e){})}catch(e){}},formatDateTime:function(e){var t=new Date(e),r=t.getFullYear(),o=t.getMonth()+1;o=o<10?"0"+o:o;var a=t.getDate();a=a<10?"0"+a:a;var i=t.getHours();i=i<10?"0"+i:i;var l=t.getMinutes(),n=t.getSeconds();return r+"-"+o+"-"+a+" "+i+":"+(l=l<10?"0"+l:l)+":"+(n=n<10?"0"+n:n)},handleBack:function(){this.$emit("input",!1)}},watch:{id:function(e,t){this._getData()}},filters:{},components:{}},D={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"role-height"},[e.bSing?r("el-col",{attrs:{span:14}},[r("v-item-detail",{staticClass:"m-t-36",attrs:{tooltip:!0,label:"角色名称：",span:e.span}},[r("span",{staticClass:"block text-ellipsis"},[e._v(e._s(e.detailRoleForm.name))]),e._v(" "),r("div",{staticClass:"tooltip-item",attrs:{slot:"content"},slot:"content"},[e._v(e._s(e.detailRoleForm.name))])]),e._v(" "),r("v-item-detail",{attrs:{tooltip:!0,label:"所属角色组：",span:e.span}},[r("span",{staticClass:"block text-ellipsis"},[e._v(e._s(e.detailRoleForm.roleGroupName))]),e._v(" "),r("div",{staticClass:"tooltip-item",attrs:{slot:"content"},slot:"content"},[e._v(e._s(e.detailRoleForm.roleGroupName))])]),e._v(" "),r("v-item-detail",{attrs:{tooltip:!0,label:"创建人：",span:e.span}},[r("span",{staticClass:"block text-ellipsis"},[e._v(e._s(e.detailRoleForm.createUser))]),e._v(" "),r("div",{staticClass:"tooltip-item",attrs:{slot:"content"},slot:"content"},[e._v(e._s(e.detailRoleForm.createUser))])]),e._v(" "),r("v-item-detail",{attrs:{tooltip:!0,label:"创建时间：",span:e.span}},[r("span",{staticClass:"block text-ellipsis"},[e._v(e._s(e.detailRoleForm.createTime))]),e._v(" "),r("div",{staticClass:"tooltip-item",attrs:{slot:"content"},slot:"content"},[e._v(e._s(e.detailRoleForm.createTime))])]),e._v(" "),r("v-item-detail",{attrs:{tooltip:!1,label:"角色授权：",span:e.span}},[r("span",{directives:[{name:"show",rawName:"v-show",value:!e.roleTree.length,expression:"!roleTree.length"}],staticClass:"block text-ellipsis"},[e._v("暂无数据")]),e._v(" "),r("el-tree",{directives:[{name:"show",rawName:"v-show",value:e.roleTree.length,expression:"roleTree.length"}],staticClass:"treeGroup",attrs:{"empty-text":"暂无数据","default-expand-all":!0,data:e.roleTree,props:e.defaultProps,"node-key":"id",accordion:""}})],1),e._v(" "),r("v-item-detail",{attrs:{tooltip:!0,label:"备注：",span:e.span}},[r("span",{staticClass:"block showAllText"},[e._v(e._s(e.detailRoleForm.remark))]),e._v(" "),r("div",{staticClass:"tooltip-item showAllText",attrs:{slot:"content"},slot:"content"},[e._v(e._s(e.detailRoleForm.remark))])]),e._v(" "),r("div",{staticClass:"text-center m-t-30-role"},[r("el-button",{attrs:{size:e.btnSize},on:{click:e.handleBack}},[e._v("返回")])],1)],1):e._e()],1)])},staticRenderFns:[]};var k=r("VU/8")(w,D,!1,function(e){r("ZG/7")},"data-v-914a1088",null).exports,F={data:function(){return{span:8,bSing:!1,btnSize:i.a.baseBtn,detailRoleGroupForm:{id:"",name:"",menus:[],code:"",remark:"",enable:"",name_:"",roleGroupId:"",parentId:""},roleGroupTree:[],defaultProps:{children:"children",label:"name"}}},props:{id:{type:Number,default:function(){return-1}}},watch:{id:function(e,t){var r=this;Object(s.l)({id:this.id}).then(function(e){r.detailRoleGroupForm={},e.data.createTime=r.formatDateTime(e.data.createTime),r.detailRoleGroupForm=e.data,Object(s.k)({id:r.id}).then(function(e){r.roleGroupTree=[],r.roleGroupTree=e.data}).catch(function(e){})}).catch(function(e){})}},created:function(){this.bSing=!0,this._getData()},mounted:function(){},methods:{_getData:function(){var e=this;if(-1!==this.id)Object(s.l)({id:this.id}).then(function(t){t.data.createTime=e.formatDateTime(t.data.createTime),e.detailRoleGroupForm=t.data,Object(s.k)({id:e.id}).then(function(t){e.roleGroupTree=t.data}).catch(function(e){})}).catch(function(e){});else try{throw new Error("异常数据")}catch(e){}},formatDateTime:function(e){var t=new Date(e),r=t.getFullYear(),o=t.getMonth()+1;o=o<10?"0"+o:o;var a=t.getDate();a=a<10?"0"+a:a;var i=t.getHours();i=i<10?"0"+i:i;var l=t.getMinutes(),n=t.getSeconds();return r+"-"+o+"-"+a+" "+i+":"+(l=l<10?"0"+l:l)+":"+(n=n<10?"0"+n:n)},handleBack:function(){this.$emit("input",!1)}},filters:{},components:{}},x={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"role-height"},[e.bSing?r("el-col",{attrs:{span:14}},[r("v-item-detail",{staticClass:"m-t-34",attrs:{tooltip:!0,label:"角色组名称：",span:e.span}},[r("span",{staticClass:"block text-ellipsis"},[e._v(e._s(e.detailRoleGroupForm.name))]),e._v(" "),r("div",{staticClass:"tooltip-item",attrs:{slot:"content"},slot:"content"},[e._v(e._s(e.detailRoleGroupForm.name))])]),e._v(" "),r("v-item-detail",{attrs:{tooltip:!0,label:"创建人：",span:e.span}},[r("span",{staticClass:"block text-ellipsis"},[e._v(e._s(e.detailRoleGroupForm.createBy))]),e._v(" "),r("div",{staticClass:"tooltip-item",attrs:{slot:"content"},slot:"content"},[e._v(e._s(e.detailRoleGroupForm.createBy))])]),e._v(" "),r("v-item-detail",{attrs:{tooltip:!0,label:"创建时间：",span:e.span}},[r("span",{staticClass:"block text-ellipsis"},[e._v(e._s(e.detailRoleGroupForm.createTime))]),e._v(" "),r("div",{staticClass:"tooltip-item",attrs:{slot:"content"},slot:"content"},[e._v(e._s(e.detailRoleGroupForm.createTime))])]),e._v(" "),r("v-item-detail",{attrs:{tooltip:!1,label:"角色组授权：",span:e.span}},[r("span",{directives:[{name:"show",rawName:"v-show",value:!e.roleGroupTree.length,expression:"!roleGroupTree.length"}],staticClass:"block text-ellipsis"},[e._v("暂无数据")]),e._v(" "),r("el-tree",{directives:[{name:"show",rawName:"v-show",value:e.roleGroupTree.length,expression:"roleGroupTree.length"}],staticClass:"treeGroup",attrs:{"empty-text":"暂无数据","default-expand-all":!0,data:e.roleGroupTree,props:e.defaultProps,"node-key":"id",accordion:""}})],1),e._v(" "),r("v-item-detail",{attrs:{tooltip:!0,label:"备注：",span:e.span}},[r("span",{staticClass:"block showAllText"},[e._v(e._s(e.detailRoleGroupForm.remark))]),e._v(" "),r("div",{staticClass:"tooltip-item showAllText",attrs:{slot:"content"},slot:"content"},[e._v(e._s(e.detailRoleGroupForm.remark))])]),e._v(" "),r("div",{staticClass:"text-center m-t-32"},[r("el-button",{attrs:{size:e.btnSize},on:{click:e.handleBack}},[e._v("返回")])],1)],1):e._e()],1)])},staticRenderFns:[]};var E={props:{},data:function(){return{btnSize:i.a.homeBtn,isAdd:!1,isRoleGroup:!0,isEdit:!1,isDelete:!1,isDetail:!1,currentRoleId:-1,currentRoleGroupId:-1,tableData:[],roleGroupId:"",initId:"",roleGroupData:[],roleGroupDetail:{},addNewRoleWithGroupData:"",roleData:[]}},computed:{},watch:{},created:function(){},mounted:function(){this.initRoleGroupData({isRoleGroup:!0,isFirstLoad:!0})},methods:{testDeleteRole:function(){this.initRoleGroupData({isRoleGroup:!0,groupId:90,delete:!0})},testAddRole:function(){this.initRoleGroupData({id:91,isRoleGroup:!1,groupId:125,roleId:91})},initRoleGroupData:function(e){var t=this;if(e.cancel){if(e.id)return void(e.isRoleGroup?(this.currentRoleId=-1,this.detailRoleGroup(e)):(this.currentRoleGroupId=-1,this.detailRole(e)));if(e.isRoleGroup){this.currentRoleId=-1,e.groupId=this.tableData[0].id;var r=a()({},e,{id:e.groupId});this.detailRoleGroup(r),this._roleGroupDetail(this.currentRoleGroupId),this.$refs.tableView.updateSelect(this.currentRoleGroupId,null,!0)}else{this.currentRoleId=-1;var o=a()({},e,{id:e.groupId});this.detailRoleGroup(o),this._roleGroupDetail(this.currentRoleGroupId),this.$refs.tableView.updateSelect(this.currentRoleGroupId,null)}}else{var i=e.delete||!1;if(this.isEdit&&!i)return e.isRoleGroup?this.currentRoleGroupId=e.groupId:this.currentRoleId=e.roleId,this.isDetail=!0,this.isAdd=!1,this.isEdit=!1,void(this.isRoleGroup=e.isRoleGroup);this.isRoleGroup=e.isRoleGroup,!e.isRoleGroup||null!==e.groupId&&void 0!==e.groupId&&""!==e.groupId||this.$refs.tableView.refreshTableView(),Object(s.m)().then(function(r){t.isRoleGroup?t.currentRoleGroupId=e.groupId:(t.currentRoleId=e.roleId,t.currentRoleGroupId=-1);try{if(t.roleGroupData=[],t.tableData=[],e.groupId||(t.currentRoleGroupId=r.data[0].id),r.data.forEach(function(e,r){e.groupIndex_=r,e.isRoleGroup=!0,e.children=[],t.roleGroupData.push(e)}),t.tableData=t.roleGroupData,r.data.length>0)if(t.isDetail=!0,t.isAdd=!1,t.isEdit=!1,t.isRoleGroup)t.currentRoleId=-1,t._roleGroupDetail(t.currentRoleGroupId),t.$refs.tableView.updateSelect(t.currentRoleGroupId,null,e.isFirstLoad);else try{t.$refs.tableView.updateSelect(e.groupId,e.roleId)}catch(e){}}catch(e){}}).catch(function(e){})}},_roleGroupDetail:function(e){var t=this;try{if(-1===e){try{throw new Error("异常数据--index")}catch(e){}return}Object(s.l)({id:e}).then(function(r){t.currentRoleGroupId=r.data.id,t.isDetail=!0,t.isAdd=!1,t.isEdit=!1,t.isRoleGroup=!0,t.roleGroupId=r.data.id,t.roleGroupDetail=r.data,Object(s.k)({id:e}).then(function(e){t.roleGroupTree=e.data}).catch(function(e){})}).catch(function(e){})}catch(e){}},createRoleGroup:function(e){this.isAdd=!0,this.isEdit=!1,this.isDetail=!1,this.isRoleGroup=!0,this.currentRoleId=-1,this.currentRoleGroupId=-1},createRole:function(e){this.roleGroupDetail={roleId:"",roleName:"",roleGroupId:e.id,roleGroupCode:e.code,roleGroupRemark:e.remark,roleGroupName:e.name,isNew:!0},this.isAdd=!0,this.isRoleGroup=!1,this.isEdit=!1,this.isDetail=!1,this.currentRoleId="",this.currentRoleGroupId=e.id},editRole:function(e){this.roleGroupDetail={roleId:e.id,roleName:e.name,roleGroupId:e.roleGroupId,roleGroupCode:e.code,roleRemark:e.remark,roleGroupName:e.roleGroupName,isNew:!1},this.isAdd=!1,this.isEdit=!0,this.isDetail=!1,this.isRoleGroup=!1,this.currentRoleId=e.id,this.currentRoleGroupId=e.roleGroupId},editRoleGroup:function(e){this.isAdd=!1,this.isEdit=!0,this.isDetail=!1,this.isRoleGroup=!0,this.currentRoleGroupId=e.id},delRole:function(e){this.initRoleGroupData({isRoleGroup:!0,groupId:e.roleGroupId,delete:!0})},delRoleGroup:function(e){this.initRoleGroupData({isRoleGroup:!0,delete:!0})},detailRole:function(e){this.isDetail=!1,this.isAdd=!1,this.isEdit=!1,this.isDetail=!0,this.isRoleGroup=!1,this.currentRoleId=e.id,this.currentRoleGroupId=e.roleGroupId},detailRoleGroup:function(e){this.isDetail=!1,this.isAdd=!1,this.isEdit=!1,this.isDetail=!0,this.isRoleGroup=!0,this.currentRoleGroupId=e.id,this.currentRoleId=-1},updateRoleName:function(e){this.tableData.forEach(function(t){t.id===e.roleGroupId&&t.name===e.roleGroupName&&(t.children=t.children.map(function(t){return t.id===e.id&&(t.name=e.roleNewName),t}))})},updateGroupName:function(e){this.tableData.forEach(function(t){t.id===e.id&&t.name===e.oldGroupName&&(t.name=e.newGroupName)})}},components:{RoleTable:c,AddRole:v,AddRoleGroup:_,DetailRole:k,DetailRoleGroup:r("VU/8")(F,x,!1,function(e){r("Qv0V")},"data-v-f5a90568",null).exports}},C={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("role-table",{ref:"tableView",staticClass:"role-table",attrs:{tableData:e.tableData},on:{createRole:e.createRole,createRoleGroup:e.createRoleGroup,editRole:e.editRole,editRoleGroup:e.editRoleGroup,delRole:e.delRole,delRoleGroup:e.delRoleGroup,detailRole:e.detailRole,detailRoleGroup:e.detailRoleGroup}}),e._v(" "),e.isRoleGroup&&(e.isAdd||e.isEdit)?r("add-role-group",{staticClass:"add-role-group",attrs:{id:e.currentRoleGroupId,isEdit:e.isEdit},on:{update:e.initRoleGroupData,updateGroupName:e.updateGroupName}}):e._e(),e._v(" "),e.isRoleGroup||!e.isAdd&&!e.isEdit?e._e():r("add-role",{staticClass:"add-role",attrs:{id:e.currentRoleId,groupId:e.currentRoleGroupId,isEdit:e.isEdit,roleGroupDetail:e.roleGroupDetail,tableData:e.tableData},on:{update:e.initRoleGroupData,updateRoleName:e.updateRoleName}}),e._v(" "),e.isRoleGroup&&e.isDetail?r("detail-role-group",{staticClass:"detail-role-group",attrs:{id:e.currentRoleGroupId}}):e._e(),e._v(" "),!e.isRoleGroup&&e.isDetail?r("detail-role",{staticClass:"detail-role",attrs:{id:e.currentRoleId,tableData:e.tableData}}):e._e()],1)},staticRenderFns:[]};var N=r("VU/8")(E,C,!1,function(e){r("5L5V")},"data-v-2cd31aac",null);t.default=N.exports},Qv0V:function(e,t){},"ZG/7":function(e,t){},aVTy:function(e,t){},dbke:function(e,t){},wV4v:function(e,t){},wrBq:function(e,t,r){"use strict";t.c=function(e){var t=a.checkRoleOnly;return Object(o.a)(t,{params:e})},t.b=function(e){var t=a.checkRoleGroupOnly;return Object(o.a)(t,{params:e})},t.k=function(e){var t=a.getRoleGropMenus;return Object(o.a)(t,{params:e})},t.m=function(e){var t=a.getRoleGroupList;return Object(o.a)(t,{params:e})},t.i=function(e){var t=a.getRole;return Object(o.a)(t,{params:e})},t.l=function(e){var t=a.getRoleGroupDetail;return Object(o.a)(t,{params:e})},t.n=function(e){var t=a.getRoleMenuAll;return Object(o.a)(t,{params:e})},t.a=function(e){var t=a.addRoleGroup;return Object(o.a)(t,{data:e,method:"post"})},t.h=function(e){var t=a.getEditRoleGroup;return Object(o.a)(t,{data:e,method:"put"})},t.f=function(e){var t=a.getDeleteRoleGroup;return Object(o.a)(t,{params:e,method:"delete"})},t.j=function(e){var t=a.getRoleDetail;return Object(o.a)(t,{params:e})},t.d=function(e){var t=a.getAddRole;return Object(o.a)(t,{data:e,method:"post"})},t.g=function(e){var t=a.getEditRole;return Object(o.a)(t,{data:e,method:"put"})},t.e=function(e){var t=a.getDeleteRole;return Object(o.a)(t,{params:e,method:"delete"})},t.o=function(e){var t=a.getRoleMenus;return Object(o.a)(t,{params:e})};var o=r("68+Y"),a={getRoleGropMenus:"/roleGroup/getRoleGropMenus",getRoleGroupList:"/roleGroup",getRole:"/roleGroup/getRoleGropLowerRoles",getRoleGroupDetail:"/roleGroup/getRoleGroups",getRoleMenuAll:"/menu/getMenuAll",addRoleGroup:"/roleGroup",getEditRoleGroup:"/roleGroup",getDeleteRoleGroup:"/roleGroup",getRoleMenus:"/role/getRoleMenus",getRoleList:"/role",getRoleDetail:"/role/getrole",getAddRole:"/role",getEditRole:"/role",getDeleteRole:"/role",checkRoleGroupOnly:"/roleGroup/checkRoleName",checkRoleOnly:"/role/checkRoleName"}}});