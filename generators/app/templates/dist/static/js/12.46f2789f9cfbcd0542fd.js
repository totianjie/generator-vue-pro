webpackJsonp([12],{"9K5+":function(e,t){},"9gKN":function(e,t){},"D/0A":function(e,t){},MRoD:function(e,t){},NZS0:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("woOf"),s=a.n(r),i=a("Xxa5"),n=a.n(i),o=a("exGp"),l=a.n(o),c=a("Dd8w"),d=a.n(c),u=a("QmSG"),p=a("k7T0"),m=a("QNws"),f=a("SJI6"),h=Object(f.createNamespacedHelpers)("taskManage").mapMutations,g={data:function(){return{btnSize:u.a.baseBtn,formSize:u.a.homeFormSize,rules:{isAddTaskTemp:[{required:!0,message:"请选择"}],taskCode:[{required:!0,message:"请选择一个模板来去创建新的任务"}]},params:{isAddTaskTemp:!1,taskCode:""},selectList:[],listProps:{name:"newLabel",value:"newValue"},taskTemp:null}},props:{pageFlag:{type:String,default:function(){return""}}},created:function(){"batchTasks"===this.pageFlag?this._getBatchTasksTaskAll():"runManage"===this.pageFlag&&this._getRunManageTaskAll()},methods:d()({_getBatchTasksTaskAll:function(){var e=this;return l()(n.a.mark(function t(){var a,r;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(p.g)({enable:"0"});case 2:a=t.sent,r=a.data,e._setSelectData(r);case 5:case"end":return t.stop()}},t,e)}))()},_getRunManageTaskAll:function(){var e=this;return l()(n.a.mark(function t(){var a,r;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(m.g)({enable:"0"});case 2:a=t.sent,r=a.data,e._setSelectData(r);case 5:case"end":return t.stop()}},t,e)}))()},_setSelectData:function(e){Array.isArray(e)&&(e.forEach(function(e){e.newLabel=e.taskName,e.newValue=e.taskCode}),this.selectList=s()([],e))},handlePreview:function(){var e=this.params.taskCode;if(!e)return!1;"batchTasks"===this.pageFlag?(this.setTaskCode(e),this.setPreview(!0)):"runManage"===this.pageFlag&&(this.RMsetTaskCode(e),this.RMsetPreview(!0))},handleRadioChange:function(e){this.params.isAddTaskTemp=e},handleCancel:function(){this.$emit("cancel",{step:"first"})},handleNext:function(){var e=this;this.$refs.form.validate(function(t){if(!t)return!1;e.$emit("ok",{step:"first",isAddTaskTemp:e.params.isAddTaskTemp,result:e.taskTemp})})},handleSelectChange:function(e){var t=this;this.taskTemp={},"batchTasks"===this.pageFlag&&e?Object(p.c)({taskCode:this.params.taskCode}).then(function(e){var a=e.data;t.taskTemp=s()({},a)}):"runManage"===this.pageFlag&&e&&Object(m.d)({taskCode:this.params.taskCode}).then(function(e){var a=e.data;t.taskTemp=s()({},a)})}},h(["setTaskCode","setPreview","RMsetTaskCode","RMsetPreview"]))},v={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"add-first-wrap"},[a("div",{staticClass:"content"},[a("el-col",{attrs:{span:"18",offset:"3"}},[a("el-form",{ref:"form",attrs:{model:e.params,rules:e.rules,"label-width":"300px",size:e.formSize}},[a("el-form-item",{attrs:{prop:"isAddTaskTemp",label:"是否通过已有任务为模板创建任务："}},[a("el-radio-group",{staticClass:"radio-group",on:{change:e.handleRadioChange},model:{value:e.params.isAddTaskTemp,callback:function(t){e.$set(e.params,"isAddTaskTemp",t)},expression:"params.isAddTaskTemp"}},[a("el-radio",{attrs:{label:!0}},[e._v("是")]),e._v(" "),a("el-radio",{staticClass:"ml",attrs:{label:!1}},[e._v("否")])],1)],1),e._v(" "),e.params.isAddTaskTemp?a("el-form-item",{attrs:{prop:"taskCode",label:"选择已有任务："}},[a("v-select",{staticClass:"select-box",attrs:{props:e.listProps,list:e.selectList,placeholder:"请选择一个模板来去创建新的任务",filterable:!0},on:{change:e.handleSelectChange},model:{value:e.params.taskCode,callback:function(t){e.$set(e.params,"taskCode",t)},expression:"params.taskCode"}}),e._v(" "),a("span",{staticClass:"preview",on:{click:e.handlePreview}},[e._v("预览")])],1):e._e()],1)],1)],1),e._v(" "),a("footer",{staticClass:"footer"},[a("el-button",{attrs:{size:e.btnSize},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{size:e.btnSize,type:"primary"},on:{click:e.handleNext}},[e._v("下一步")])],1)])},staticRenderFns:[]};var k=a("VU/8")(g,v,!1,function(e){a("vv6e")},"data-v-090a1c5e",null);t.default=k.exports},Omrf:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Xxa5"),s=a.n(r),i=a("exGp"),n=a.n(i),o=a("woOf"),l=a.n(o),c=a("Dd8w"),d=a.n(c),u=a("SJI6"),p=a("QmSG"),m=a("vLmQ"),f=a("QNws"),h=a("aCdx"),g=a("SVaQ"),v=Object(u.createNamespacedHelpers)("taskManage"),k=v.mapMutations,b=v.mapState,y={data:function(){return{total:0,btnSize:p.a.homeBtn,formSize:p.a.homeFormSize,listParams:{offset:1,limit:p.a.limit},val:"",listProps:{name:"keyName",value:"keyValue"},tableData:[],busiCodeDict:[],dialogVisible:!1}},props:{pageFlag:{type:String,default:function(){return""}}},computed:d()({},b({taskPriorityDict:function(e){return e.taskPriorityDict}}),{selectList:function(){var e=[];return this.busiCodeDict.forEach(function(t){e.push({keyName:t.busiName,keyValue:t.busiCode})}),e},priorityList:function(){var e=[];return this.taskPriorityDict.forEach(function(t){e.push({label:t.keyName,value:t.keyValue})}),e}}),created:function(){var e=this;Object(h.a)({enable:0}).then(function(t){e.busiCodeDict=l()([],t.data)}),this._getData()},methods:d()({_getData:function(){var e=this;return n()(s.a.mark(function t(){var a,r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(f.f)(d()({},e.listParams,{busiCode:e.val?e.val:""}));case 2:a=t.sent,r=a.data,e.tableData=l()([],r.list),e.total=r.total;case 6:case"end":return t.stop()}},t,e)}))()},handlerAdd:function(){this.RMsetIsEdit(!1),this.RMsetPage("add")},handlerSearch:function(){this._pagingInit(),this._getData()},handlerEdit:function(e){this.RMsetIsEdit(!0),this.RMsetTaskCode(e.taskCode),this.RMsetPage("add"),this.RMsetAddStep(2)},handleLook:function(e){this.RMsetTaskCode(e.taskCode),this.RMsetPage("detail")},handleCommand:function(e){var t=this;return n()(s.a.mark(function a(){return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(f.h)({taskCode:e.row.taskCode,enable:parseInt(e.item.value)});case 2:t._getData();case 4:case"end":return a.stop()}},a,t)}))()},handlePriority:function(e){var t=this;return n()(s.a.mark(function a(){return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(f.h)({taskCode:e.row.taskCode,taskPriority:parseInt(e.item.value)});case 2:t._getData();case 4:case"end":return a.stop()}},a,t)}))()},handlerRun:function(e){var t=this;return n()(s.a.mark(function a(){return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(f.c)({taskCode:e.taskCode,operType:"1"});case 2:t._getData();case 4:case"end":return a.stop()}},a,t)}))()},handlerGoOn:function(e){var t=this;return n()(s.a.mark(function a(){return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(f.c)({taskCode:e.taskCode,operType:"4"});case 2:t._getData();case 4:case"end":return a.stop()}},a,t)}))()},handlerExit:function(e){var t=this;return n()(s.a.mark(function a(){return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(f.c)({taskCode:e.taskCode,operType:"3"});case 2:t._getData();case 4:case"end":return a.stop()}},a,t)}))()},handleSuspend:function(e){var t=this;return n()(s.a.mark(function a(){return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(f.c)({taskCode:e.taskCode,operType:"2"});case 2:t._getData();case 4:case"end":return a.stop()}},a,t)}))()},handleResultPre:function(e){var t=this;return n()(s.a.mark(function a(){return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(f.c)({taskCode:e.taskCode,operType:"5"});case 2:t._getData();case 4:case"end":return a.stop()}},a,t)}))()},handleViewLog:function(e){this.dialogVisible=!0,this.$refs.dailyRecordDialog.handleDialogShow({type:"batchTasks"===this.pageFlag?1:2,taskCode:e.taskCode,executeCode:e.executeCode})},handleViewTask:function(e){this.$router.push({path:"/watchManage/taskWatch",query:{type:2,taskName:e.taskName,taskCode:e.taskCode}})},handlePagingChange:function(e){this.listParams=l()({},this.listParams,e),this._getData()},_pagingInit:function(){this.$refs.Fpage._init(),this.listParams={offset:1,limit:p.a.limit}},closeDailyDialog:function(){this.dialogVisible=!1}},k({RMsetPage:"RMsetPage",RMsetAddStep:"RMsetAddStep",RMsetTaskCode:"RMsetTaskCode",RMsetIsEdit:"RMsetIsEdit"})),components:{ListTable:m.a,DailyRecordDialog:g.a}},w={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"list-wrap"},[a("section",{staticClass:"h-fill"},[a("el-button",{staticClass:"add-btn",attrs:{type:"primary",size:e.btnSize},on:{click:e.handlerAdd}},[e._v("新增")]),e._v(" "),a("div",{staticClass:"search-wrapper"},[a("v-search-box",[a("v-input",{attrs:{pxUnit:!0,labelWidth:130,label:"业务名称："}},[a("v-select",{staticClass:"select-box",staticStyle:{width:"300px"},attrs:{size:e.formSize,props:e.listProps,list:e.selectList,placeholder:"请选择业务名称",filterable:!0},model:{value:e.val,callback:function(t){e.val=t},expression:"val"}})],1),e._v(" "),a("div",{attrs:{slot:"btn"},slot:"btn"},[a("el-button",{attrs:{type:"primary",size:e.btnSize},on:{click:e.handlerSearch}},[e._v("查询")])],1)],1)],1),e._v(" "),a("list-table",{staticStyle:{width:"100%"},attrs:{goOnShow:!0,exitShow:!0,suspendShow:!0,resultPreShow:!0,viewLogShow:!0,viewTaskShow:!0,tableData:e.tableData,priorityList:e.priorityList,pageFlag:e.pageFlag,operationWidth:480},on:{edit:e.handlerEdit,look:e.handleLook,command:e.handleCommand,priority:e.handlePriority,run:e.handlerRun,goOn:e.handlerGoOn,exit:e.handlerExit,suspend:e.handleSuspend,resultPre:e.handleResultPre,viewLog:e.handleViewLog,viewTask:e.handleViewTask}}),e._v(" "),a("v-paging",{ref:"Fpage",staticClass:"footer-paging",attrs:{total:e.total},on:{pagingChange:e.handlePagingChange}})],1),e._v(" "),a("daily-record-dialog",{ref:"dailyRecordDialog",on:{closeDailyDialog:e.closeDailyDialog},model:{value:e.dialogVisible,callback:function(t){e.dialogVisible=t},expression:"dialogVisible"}})],1)},staticRenderFns:[]};var _=a("VU/8")(y,w,!1,function(e){a("RU7c")},"data-v-e72bb34e",null);t.default=_.exports},PBxX:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Xxa5"),s=a.n(r),i=a("woOf"),n=a.n(i),o=a("exGp"),l=a.n(o),c=a("Dd8w"),d=a.n(c),u=a("SJI6"),p=a("QmSG"),m=a("vLmQ"),f=a("k7T0"),h=a("SVaQ"),g=Object(u.createNamespacedHelpers)("taskManage"),v=g.mapMutations,k=g.mapState,b={data:function(){return{total:0,btnSize:p.a.homeBtn,listParams:{offset:1,limit:p.a.limit},tableData:[],dialogVisible:!1}},props:{pageFlag:{type:String,default:function(){return""}}},computed:d()({},k({taskPriorityDict:function(e){return e.taskPriorityDict}}),{priorityList:function(){var e=[];return this.taskPriorityDict.forEach(function(t){e.push({label:t.keyName,value:t.keyValue})}),e}}),created:function(){this._getData()},methods:d()({_getData:function(){var e=this;return l()(s.a.mark(function t(){var a,r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(f.f)(e.listParams);case 2:a=t.sent,r=a.data,e.tableData=n()([],r.list),e.total=r.total;case 7:case"end":return t.stop()}},t,e)}))()},handlerAdd:function(){this.setIsEdit(!1),this.setPage("add")},handlerEdit:function(e){this.setTaskCode(e.taskCode),this.setIsEdit(!0),this.setPage("add"),this.setAddStep(2)},handleLook:function(e){this.setTaskCode(e.taskCode),this.setPage("detail")},handleCommand:function(e){var t=this;return l()(s.a.mark(function a(){return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(f.h)({taskCode:e.row.taskCode,enable:parseInt(e.item.value)});case 2:t._getData();case 4:case"end":return a.stop()}},a,t)}))()},handlePriority:function(e){var t=this;return l()(s.a.mark(function a(){return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(f.h)({taskCode:e.row.taskCode,taskPriority:parseInt(e.item.value)});case 2:t._getData();case 4:case"end":return a.stop()}},a,t)}))()},handlerRun:function(e){var t=this;return l()(s.a.mark(function a(){return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(f.b)({taskCode:e.taskCode});case 2:t._getData();case 4:case"end":return a.stop()}},a,t)}))()},handlerGoOn:function(e){},handlerExit:function(e){},handleSuspend:function(e){},handleViewLog:function(e){this.dialogVisible=!0,this.$refs.dailyRecordDialog.handleDialogShow({type:"batchTasks"===this.pageFlag?1:2,taskCode:e.taskCode,executeCode:e.executeCode})},handleViewTask:function(e){this.$router.push({path:"/watchManage/taskWatch",query:{type:1,taskCode:e.taskCode}})},handlePagingChange:function(e){this.listParams=n()({},this.listParams,e),this._getData()},closeDailyDialog:function(){this.dialogVisible=!1}},v({setPage:"setPage",setAddStep:"setAddStep",setTaskCode:"setTaskCode",setIsEdit:"setIsEdit"})),components:{ListTable:m.a,DailyRecordDialog:h.a}},y={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"list-wrap"},[a("section",{staticClass:"h-fill"},[a("el-button",{staticClass:"add-btn",attrs:{type:"primary",size:e.btnSize},on:{click:e.handlerAdd}},[e._v("新增")]),e._v(" "),a("list-table",{staticStyle:{width:"100%"},attrs:{tableData:e.tableData,priorityList:e.priorityList,pageFlag:e.pageFlag,viewLogShow:!0,operationWidth:250},on:{edit:e.handlerEdit,look:e.handleLook,command:e.handleCommand,priority:e.handlePriority,run:e.handlerRun,goOn:e.handlerGoOn,exit:e.handlerExit,suspend:e.handleSuspend,viewLog:e.handleViewLog,viewTask:e.handleViewTask}}),e._v(" "),a("v-paging",{ref:"Fpage",staticClass:"footer-paging",attrs:{total:e.total},on:{pagingChange:e.handlePagingChange}})],1),e._v(" "),a("daily-record-dialog",{ref:"dailyRecordDialog",on:{closeDailyDialog:e.closeDailyDialog},model:{value:e.dialogVisible,callback:function(t){e.dialogVisible=t},expression:"dialogVisible"}})],1)},staticRenderFns:[]};var w=a("VU/8")(b,y,!1,function(e){a("9K5+")},"data-v-6b202eb8",null);t.default=w.exports},Pyrh:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Xxa5"),s=a.n(r),i=a("exGp"),n=a.n(i),o=a("QmSG"),l=a("//Fk"),c=a.n(l),d=a("Dd8w"),u=a.n(d),p=a("IVM2"),m={taskTypeCode:[{required:!0,message:"请选择任务类型"}],taskName:[{required:!0,message:"请输入任务名称"},{pattern:p.a.text,message:"只可输入数字 、字母 、汉字"},{validator:Object(p.c)(20,"限制20字")}],remark:[{validator:Object(p.c)(50,"限制50字")}],taskParam:[{pattern:/^[a-zA-Z0-9\u4e00-\u9fa5？&=]+$/,message:"只可输入数字 、字母 、汉字？&="},{validator:Object(p.c)(50,"限制50字")}],taskTimeout:[{pattern:/^\d+$/,message:"只可输入数字"}],taskBeginTime:[{required:!0,message:"请选择"}],taskCycleType:[{required:!0,message:"请选择"}],triggerDate:[{required:!0,message:"请选择"}],taskTriggerType:[{required:!0,message:"请选择"}],triggerDay:[{required:!0,message:"请选择"}],triggerTime:[{required:!0,message:"请选择"}],triggerWeek:[{required:!0,message:"请选择"}],triggerHour:[{required:!0,message:"请输入"},{pattern:/^([1-9]||1[0-9]||2[0-4])$/,message:"可输入1的整数倍  最大 24"}],triggerMinute:[{required:!0,message:"请输入"},{pattern:/^([1-9]||[1-9][0-9]||1[0-1][0-9]||120)$/,message:"每分 为整数 最大  120"}],code22:[{validator:Object(p.c)(100,"限制100字")},{validator:function(e,t,a){var r=(t+"").replace(/(^\s*)|(\s*$)/g,"");if(0===r.length)return a(),!1;for(var s=r.split(";"),i=0;i<s.length;i++)if(!p.a.email.test(s[i]))return a(new Error("格式不正确")),!1;a()},trigger:"blur"}],code23:[{validator:Object(p.c)(100,"限制100字")},{validator:function(e,t,a){var r=(t+"").replace(/(^\s*)|(\s*$)/g,"");if(0===r.length)return a(),!1;for(var s=r.split(";"),i=0;i<s.length;i++)if(!p.a.phone.test(s[i]))return a(new Error("格式不正确")),!1;a()},trigger:"blur"}],code24:[{validator:Object(p.c)(100,"限制100字")},{validator:function(e,t,a){var r=(t+"").replace(/(^\s*)|(\s*$)/g,"");if(0===r.length)return a(),!1;for(var s=r.split(";"),i=0;i<s.length;i++)if(!s[i].startsWith("http://"))return a(new Error("格式不正确")),!1;a()},trigger:"blur"}],taskPriority:[{required:!0,message:"请选择"}],enable:[{required:!0,message:"请选择"}]},f=a("SJI6"),h=Object(f.createNamespacedHelpers)("taskManage").mapState,g={data:function(){return{weeks:[{label:"星期日",value:1},{label:"星期一",value:2},{label:"星期二",value:3},{label:"星期三",value:4},{label:"星期四",value:5},{label:"星期五",value:6},{label:"星期六",value:7}],btnSize:o.a.baseBtn,formSize:o.a.homeFormSize,rules:m,listProps:{name:"keyName",value:"keyValue"},pickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}}}},props:{addParams:{type:Object,default:function(){return{}}},pageFlag:{type:String,default:function(){return""}}},computed:u()({},h(["taskTypeDict","taskImplDict","taskCycleTypeDict","taskPriorityDict","isEdit","RMisEdit"]),{taskStatusShow:function(){return"batchTasks"===this.pageFlag?this.isEdit:this.RMisEdit}}),methods:{_test:function(e){var t=this;return new c.a(function(e,a){t.$refs.form.validate(function(t){t?e(t):a(t)})})},handleDateTimeChange:function(e){},handleRadioChange:function(e){for(var t=1;t<=6;)t++}}},v={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.addParams,rules:e.rules,"label-width":"200px",size:e.formSize}},[a("el-form-item",{attrs:{prop:"taskName",label:"任务名称："}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.addParams.taskName,callback:function(t){e.$set(e.addParams,"taskName",t)},expression:"addParams.taskName"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"remark",label:"任务备注："}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.addParams.remark,callback:function(t){e.$set(e.addParams,"remark",t)},expression:"addParams.remark"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"taskParam",label:"任务参数设定："}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.addParams.taskParam,callback:function(t){e.$set(e.addParams,"taskParam",t)},expression:"addParams.taskParam"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"taskBeginTime",label:"任务启动日期："}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date","value-format":"timestamp","picker-options":e.pickerOptions,placeholder:"请选择日期"},model:{value:e.addParams.taskBeginTime,callback:function(t){e.$set(e.addParams,"taskBeginTime","string"==typeof t?t.trim():t)},expression:"addParams.taskBeginTime"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"taskEndTime",label:"任务终止日期："}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date","value-format":"timestamp","picker-options":e.pickerOptions,placeholder:"请选择日期"},model:{value:e.addParams.taskEndTime,callback:function(t){e.$set(e.addParams,"taskEndTime","string"==typeof t?t.trim():t)},expression:"addParams.taskEndTime"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"taskCycleType",label:"任务周期类型："}},[a("v-select",{staticClass:"select-box",attrs:{props:e.listProps,list:e.taskCycleTypeDict,placeholder:"请选择任务周期类型",filterable:!0},model:{value:e.addParams.taskCycleType,callback:function(t){e.$set(e.addParams,"taskCycleType",t)},expression:"addParams.taskCycleType"}})],1),e._v(" "),"1"===e.addParams.taskCycleType?a("el-form-item",{attrs:{prop:"triggerDate"}},[a("el-date-picker",{staticClass:"my-date-picker",staticStyle:{width:"100%"},attrs:{type:"datetime","value-format":"timestamp",placeholder:"选择日期时间",clearable:!1,"picker-options":e.pickerOptions},on:{change:e.handleDateTimeChange},model:{value:e.addParams.triggerDate,callback:function(t){e.$set(e.addParams,"triggerDate",t)},expression:"addParams.triggerDate"}})],1):e._e(),e._v(" "),"2"===e.addParams.taskCycleType?a("el-form-item",{attrs:{prop:"taskTriggerType",label:"任务时间设定："}},[a("el-radio-group",{staticClass:"radio-group",on:{change:e.handleRadioChange},model:{value:e.addParams.taskTriggerType,callback:function(t){e.$set(e.addParams,"taskTriggerType",t)},expression:"addParams.taskTriggerType"}},[a("el-col",{staticStyle:{"margin-top":"15px"},attrs:{span:24}},[a("el-radio",{staticStyle:{width:"33.33%"},attrs:{label:1}},[e._v("每月")]),e._v(" "),a("el-radio",{staticClass:"ml",staticStyle:{width:"33.33%"},attrs:{label:2}},[e._v("每2星期")]),e._v(" "),a("el-radio",{staticClass:"ml",staticStyle:{width:"33.33%"},attrs:{label:3}},[e._v("每星期")])],1),e._v(" "),a("el-col",{staticStyle:{"margin-top":"15px"},attrs:{span:"24"}},[a("el-radio",{staticClass:"ml",staticStyle:{width:"33.33%"},attrs:{label:4}},[e._v("每天")]),e._v(" "),a("el-radio",{staticClass:"ml",staticStyle:{width:"33.33%"},attrs:{label:5}},[e._v("每隔小时")]),e._v(" "),a("el-radio",{staticClass:"ml",staticStyle:{width:"33.33%"},attrs:{label:6}},[e._v("每隔分")])],1)],1)],1):e._e(),e._v(" "),"2"===e.addParams.taskCycleType&&1===e.addParams.taskTriggerType?a("el-form-item",{ref:"list1"},[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"triggerDay"}},[a("el-select",{attrs:{placeholder:"请选择每月日期"},model:{value:e.addParams.triggerDay,callback:function(t){e.$set(e.addParams,"triggerDay",t)},expression:"addParams.triggerDay"}},e._l(28,function(e){return a("el-option",{key:e,attrs:{label:e+"日",value:e}})}),1)],1)],1),e._v(" "),a("el-col",{staticClass:"text-center",attrs:{span:2}},[e._v(" ")]),e._v(" "),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"triggerTime"}},[a("el-time-picker",{staticStyle:{width:"100%"},attrs:{clearable:!1,"value-format":"HH:mm",format:"HH:mm","picker-options":{format:"HH:mm"},placeholder:"请选择时间"},model:{value:e.addParams.triggerTime,callback:function(t){e.$set(e.addParams,"triggerTime",t)},expression:"addParams.triggerTime"}})],1)],1)],1):e._e(),e._v(" "),"2"!==e.addParams.taskCycleType||2!==e.addParams.taskTriggerType&&3!==e.addParams.taskTriggerType?e._e():a("el-form-item",{ref:"list2"},[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"triggerWeek"}},[a("el-select",{attrs:{placeholder:"请选择每月日期"},model:{value:e.addParams.triggerWeek,callback:function(t){e.$set(e.addParams,"triggerWeek",t)},expression:"addParams.triggerWeek"}},e._l(e.weeks,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("el-col",{staticClass:"text-center",attrs:{span:2}},[e._v(" ")]),e._v(" "),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"triggerTime"}},[a("el-time-picker",{staticStyle:{width:"100%"},attrs:{clearable:!1,"value-format":"HH:mm",format:"HH:mm","picker-options":{format:"HH:mm"},placeholder:"请选择时间"},model:{value:e.addParams.triggerTime,callback:function(t){e.$set(e.addParams,"triggerTime",t)},expression:"addParams.triggerTime"}})],1)],1)],1),e._v(" "),"2"===e.addParams.taskCycleType&&4===e.addParams.taskTriggerType?a("el-form-item",{ref:"list4",attrs:{prop:"triggerTime"}},[a("el-time-picker",{staticStyle:{width:"100%"},attrs:{clearable:!1,"value-format":"HH:mm",format:"HH:mm","picker-options":{format:"HH:mm"},placeholder:"请选择时间"},model:{value:e.addParams.triggerTime,callback:function(t){e.$set(e.addParams,"triggerTime",t)},expression:"addParams.triggerTime"}})],1):e._e(),e._v(" "),"2"===e.addParams.taskCycleType&&5===e.addParams.taskTriggerType?a("el-form-item",{ref:"list5",attrs:{prop:"triggerHour"}},[a("el-input",{attrs:{placeholder:"请输入时间"},model:{value:e.addParams.triggerHour,callback:function(t){e.$set(e.addParams,"triggerHour",t)},expression:"addParams.triggerHour"}})],1):e._e(),e._v(" "),"2"===e.addParams.taskCycleType&&6===e.addParams.taskTriggerType?a("el-form-item",{ref:"list6",attrs:{prop:"triggerMinute"}},[a("el-input",{attrs:{placeholder:"请输入时间"},model:{value:e.addParams.triggerMinute,callback:function(t){e.$set(e.addParams,"triggerMinute",t)},expression:"addParams.triggerMinute"}})],1):e._e(),e._v(" "),a("el-form-item",{attrs:{prop:"taskPriority",label:"任务优先级："}},[a("el-select",{staticClass:"w-fill",attrs:{placeholder:"请选择"},model:{value:e.addParams.taskPriority,callback:function(t){e.$set(e.addParams,"taskPriority",t)},expression:"addParams.taskPriority"}},e._l(e.taskPriorityDict,function(e){return a("el-option",{key:e.keyValue,attrs:{label:e.keyName,value:e.keyValue}})}),1)],1),e._v(" "),e.taskStatusShow?a("el-form-item",{attrs:{prop:"enable",label:"任务状态："}},[a("el-radio-group",{staticClass:"w-fill",model:{value:e.addParams.enable,callback:function(t){e.$set(e.addParams,"enable",t)},expression:"addParams.enable"}},[a("el-col",{attrs:{span:8}},[a("el-radio",{staticClass:"block",attrs:{label:1}},[e._v("启用")])],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-radio",{staticClass:"block",attrs:{label:0}},[e._v("禁用")])],1)],1)],1):e._e()],1)},staticRenderFns:[]};var k=a("VU/8")(g,v,!1,function(e){a("D/0A")},null,null).exports,b=a("mvHQ"),y=a.n(b),w=a("woOf"),_=a.n(w),C=a("k7T0"),T=a("aCdx"),P=Object(f.createNamespacedHelpers)("taskManage").mapState,x={data:function(){var e=this;return{btnSize:o.a.baseBtn,formSize:o.a.homeFormSize,lookOverDialog:!1,num:0,rules:{busiCode:[{required:!0,message:"请选择业务名称"}],spiltType:[{required:!0,message:"请选择"}],spiltNum:[{validator:function(t,a,r){if(1===e.addParams.spiltType){if(""===a)return r(new Error("请输入")),!1;if(!/^\d+$/.test(a))return r(new Error("只可输入数字123")),!1;if(!/^([1-9]|1[0-5])$/.test(a))return r(new Error("只能划分1-15之间")),!1}r()},trigger:"blur"}],spiltStrip:[{validator:function(t,a,r){if(2===e.addParams.spiltType){if(""===a)return r(new Error("请输入")),!1;if(!/^\d+$/.test(a))return r(new Error("只可输入数字")),!1}r()},trigger:"blur"}]},listRules:{searchCode:[{required:!0,message:"请选择"}],conditionType:[{required:!0,message:"请选择"}],relation:[{required:!0,message:"请选择"}],searchVal1:[{required:!0,message:"请输入"}],searchVal2:[{required:!0,message:"请输入"}]},lookOverData:[{label:"源库：",value:""},{label:"中间库：",value:""},{label:"平台数据库：",value:""},{label:"业务库：",value:""}],listProps:{name:"keyName",value:"keyValue"},tempObj:{searchCode:"",conditionType:"",relation:"",searchVal1:"",searchVal2:""},list:[],busiCodeDict:[]}},props:{addParams:{type:Object,default:function(){return{}}}},computed:u()({},P(["searchCodeDict","conditionTypeDict","relationDict"]),{selectList:function(){var e=[];return this.busiCodeDict.forEach(function(t){e.push({keyName:t.busiName,keyValue:t.busiCode})}),e}}),created:function(){var e=this;Object(T.a)({enable:1}).then(function(t){e.busiCodeDict=_()([],t.data)})},mounted:function(){this.form2=this.$refs.form2},methods:{searchValPlaceholder:function(e){var t=e.searchCode,a=this.searchCodeDict.find(function(e){return e.keyValue===t});return a&&"string"!==a.type?"number"===a.type?"请输入数字":"date"===a.type?"请输入日期yyyy-MM-dd hh:mm:ss或yyyy-MM-dd":void 0:"请输入"},searchVal1Validator:function(e){var t=e.searchCode,a=this.searchCodeDict.find(function(e){return e.keyValue===t});return function(e,t,r){if(void 0===a)return r(),!1;var s=a.type;if("date"===s&&""===t||"number"===s&&""===t)return r(new Error("请输入")),!1;switch(s){case"date":if(!/^(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2})|(\d{4}-\d{2}-\d{2})$/.test(t))return r(new Error("格式为:yyyy-MM-dd hh:mm:ss或yyyy-MM-dd")),!1;break;case"number":if(!/^\d+$/.test(t))return r(new Error("只可输入数字")),!1}r()}},_test:function(){var e=this;return n()(s.a.mark(function t(){var a,r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,new c.a(function(t,a){return e.form2.validate(function(e){return e?t(e):a(e)})});case 3:return a=t.sent,t.next=6,new c.a(function(t,a){for(var r=!0,s=0;s<e.addParams.conditionList.length;s++)e.$refs["form_list"+s][0].validate(function(e){e||(r=!1)});r?t(!0):a(!1)});case 6:return r=t.sent,t.abrupt("return",c.a.all([a,r]));case 8:case"end":return t.stop()}},t,e)}))()},handleDelete:function(e){this.addParams.conditionList.splice(e,1)},handleRadioChange:function(e){switch(this.addParams.spiltType){case 1:this.$refs.spiltNum.resetField();break;case 2:this.$refs.spiltStrip.resetField()}},handleGetDataAll:function(){var e=this;return n()(s.a.mark(function t(){var a,r,i;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(a=e.addParams.busiCode)){t.next=8;break}return t.next=5,Object(T.e)({busiCode:a});case 5:r=t.sent,i=r.data,e.num=i;case 8:case"end":return t.stop()}},t,e)}))()},handleLookOver:function(){var e=this,t=this.addParams.busiCode;if(!this.addParams.busiCode)return!1;Object(C.d)({busiCode:t}).then(function(t){var a=t.data;if(a){var r=a.sourceDbCode,s=a.middleDbCode,i=a.platDbCode,n=a.serviceDbCode;e.lookOverData=_()([],[{label:"源库：",value:r},{label:"中间库：",value:s},{label:"平台数据库：",value:i},{label:"业务库：",value:n}]),e.lookOverDialog=!0}})},handleAddCondition:function(){this.addParams.conditionList.length<=8&&this.addParams.conditionList.push(JSON.parse(y()(this.tempObj)))}},components:{FormCom:k}},S={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("el-form",{ref:"form2",attrs:{model:e.addParams,rules:e.rules,"label-width":"200px",size:e.formSize}},[a("el-form-item",{attrs:{prop:"busiCode",label:"业务名称："}},[a("v-select",{attrs:{props:e.listProps,list:e.selectList,placeholder:"请选择业务名称",filterable:!0},model:{value:e.addParams.busiCode,callback:function(t){e.$set(e.addParams,"busiCode",t)},expression:"addParams.busiCode"}}),e._v(" "),a("span",{staticClass:"look-over-btn",on:{click:e.handleLookOver}},[e._v("查看")])],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:e.btnSize},on:{click:e.handleGetDataAll}},[e._v("获取数据总数")]),e._v(" "),a("span",{staticClass:"disab",domProps:{textContent:e._s(e.num)}}),e._v("条\n        ")],1),e._v(" "),a("el-form-item",{attrs:{required:""}},[a("el-form-item",{attrs:{prop:"spiltType"}},[a("el-radio-group",{on:{change:e.handleRadioChange},model:{value:e.addParams.spiltType,callback:function(t){e.$set(e.addParams,"spiltType",t)},expression:"addParams.spiltType"}},[a("el-radio",{staticClass:"block",attrs:{label:1}},[e._v("\n                        批次拆分\n                        "),a("div",{staticStyle:{display:"inline-block",width:"106px",height:"32px"}}),e._v("\n                        个批次均分\n                    ")]),e._v(" "),a("el-radio",{staticClass:"block",staticStyle:{"margin-top":"20px"},attrs:{label:2}},[e._v("\n                        批次拆分\n                        "),a("div",{staticStyle:{display:"inline-block",width:"106px",height:"32px"}}),e._v("\n                        条病例/批次\n                    ")])],1)],1),e._v(" "),a("el-form-item",{ref:"spiltNum",staticStyle:{position:"absolute",left:"89px",top:"10px"},attrs:{prop:"spiltNum"}},[a("el-input",{staticStyle:{width:"106px"},model:{value:e.addParams.spiltNum,callback:function(t){e.$set(e.addParams,"spiltNum","string"==typeof t?t.trim():t)},expression:"addParams.spiltNum"}})],1),e._v(" "),a("el-form-item",{ref:"spiltStrip",staticStyle:{position:"absolute",left:"89px",top:"66px"},attrs:{prop:"spiltStrip"}},[a("el-input",{staticStyle:{width:"106px"},model:{value:e.addParams.spiltStrip,callback:function(t){e.$set(e.addParams,"spiltStrip","string"==typeof t?t.trim():t)},expression:"addParams.spiltStrip"}})],1)],1),e._v(" "),a("el-form-item",{staticClass:"add-condition-btn",attrs:{label:"数据限制条件："}},[a("span",{on:{click:e.handleAddCondition}},[e._v("新增限制条件")])])],1),e._v(" "),a("el-dialog",{attrs:{title:"查看",visible:e.lookOverDialog,width:"404px"},on:{"update:visible":function(t){e.lookOverDialog=t}}},[a("ul",{staticClass:"look-over-wrap"},e._l(e.lookOverData,function(t,r){return a("li",{key:r},[a("span",{staticClass:"title text-ellipsis",domProps:{textContent:e._s(t.label)}}),e._v(" "),a("span",{staticClass:"text text-ellipsis",attrs:{title:t.value},domProps:{textContent:e._s(t.value)}})])}),0)]),e._v(" "),e._l(e.addParams.conditionList,function(t,r){return a("el-form",{key:r,ref:"form_list"+r,refInFor:!0,staticStyle:{position:"relative","margin-bottom":"20px"},attrs:{model:t,rules:e.listRules,"label-width":"200px",size:e.formSize}},[a("el-form-item",{staticStyle:{margin:"0"}},[a("el-col",{staticStyle:{"padding-right":"10px"},attrs:{span:8}},[a("el-form-item",{attrs:{prop:"searchCode"}},[a("v-select",{attrs:{props:e.listProps,list:e.searchCodeDict,placeholder:"请选择限制字段",filterable:!0},model:{value:t.searchCode,callback:function(a){e.$set(t,"searchCode",a)},expression:"item.searchCode"}})],1)],1),e._v(" "),a("el-col",{staticStyle:{padding:"0 5px"},attrs:{span:8}},[a("el-form-item",{attrs:{prop:"conditionType"}},[a("v-select",{attrs:{props:e.listProps,list:e.conditionTypeDict,placeholder:"请选择条件",filterable:!0},model:{value:t.conditionType,callback:function(a){e.$set(t,"conditionType",a)},expression:"item.conditionType"}})],1)],1),e._v(" "),a("el-col",{staticStyle:{"padding-left":"10px"},attrs:{span:8}},[a("el-form-item",{attrs:{prop:"relation"}},[a("v-select",{attrs:{props:e.listProps,list:e.relationDict,placeholder:"请选择逻辑关系",filterable:!0},model:{value:t.relation,callback:function(a){e.$set(t,"relation",a)},expression:"item.relation"}})],1)],1)],1),e._v(" "),a("el-form-item",{staticStyle:{margin:"0"}},[a("el-form-item",{staticStyle:{margin:"0"},attrs:{prop:"searchVal1",rules:[{validator:e.searchVal1Validator(t),trigger:"blur"}]}},["8"!==t.conditionType?a("el-input",{attrs:{placeholder:e.searchValPlaceholder(t)},model:{value:t.searchVal1,callback:function(a){e.$set(t,"searchVal1","string"==typeof a?a.trim():a)},expression:"item.searchVal1"}}):e._e()],1),e._v(" "),"8"===t.conditionType?a("el-row",[a("el-col",{attrs:{span:11}},[a("el-form-item",{staticStyle:{margin:"0"},attrs:{prop:"searchVal1",rules:[{validator:e.searchVal1Validator(t),trigger:"blur"}]}},[a("el-input",{attrs:{placeholder:e.searchValPlaceholder(t)},model:{value:t.searchVal1,callback:function(a){e.$set(t,"searchVal1",a)},expression:"item.searchVal1"}})],1)],1),e._v(" "),a("el-col",{staticClass:"text-center",attrs:{span:2}},[e._v(" ")]),e._v(" "),a("el-col",{attrs:{span:11}},[a("el-form-item",{staticStyle:{margin:"0"},attrs:{prop:"searchVal1",rules:[{validator:e.searchVal1Validator(t),trigger:"blur"}]}},[a("el-input",{attrs:{placeholder:e.searchValPlaceholder(t)},model:{value:t.searchVal2,callback:function(a){e.$set(t,"searchVal2",a)},expression:"item.searchVal2"}})],1)],1)],1):e._e()],1),e._v(" "),a("span",{staticClass:"delete-btn",on:{click:function(t){return e.handleDelete(r)}}},[e._v("删除")])],1)})],2)},staticRenderFns:[]};var D=a("VU/8")(x,S,!1,function(e){a("jFJA")},"data-v-6c299a3e",null).exports,M=a("QNws"),R=Object(f.createNamespacedHelpers)("taskManage").mapMutations,O={data:function(){return{btnSize:o.a.baseBtn,formSize:o.a.homeFormSize,rules:{splitTaskCode:[{required:!0,message:"请选择批次划分任务名称"}],code2:[{required:!0,message:"请输入"}],code3:[{required:!0,message:"请输入"}],code4:[{required:!0,message:"请输入"}],code5:[{required:!0,message:"请输入"}],code6:[{required:!0,message:"请输入"}],beginHandle:[{required:!0,message:"请选择"}],errorHandle:[{required:!0,message:"请选择"}],appId:[{required:!0,message:"请选择场景名称"}]},selectList:[],listProps:{name:"keyName",value:"keyValue"},appids:[]}},watch:{splitTaskCode_:function(e,t){this.changeSplitTaskCode(this.addParams.splitTaskCode,void 0===t)}},props:{addParams:{type:Object,default:function(){return{}}}},computed:{splitTaskCode_:function(){return this.addParams.splitTaskCode}},created:function(){var e=this;Object(C.g)({enable:0}).then(function(t){var a=t.data;e.selectList=[],a.forEach(function(t){e.selectList.push({keyName:t.taskName,keyValue:t.taskCode})})})},mounted:function(){this.form2=this.$refs.form_other_run},methods:u()({changeAppName:function(e){this.addParams.splitTaskCode||(this.$toast("请先选择批次划分任务名称才能选择和修改场景名称"),this.$refs.selectRef.blurEvent())},changeSplitTaskCode:function(e){var t=this;arguments.length>1&&void 0!==arguments[1]&&arguments[1]||(this.addParams.appId=""),this.appids=[],e&&Object(M.b)({splitTaskCode:e}).then(function(e){e.data.forEach(function(e){t.appids.push({keyName:e.appName||e.appId,keyValue:e.appId})})})},_test:function(){var e=this;return n()(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new c.a(function(t,a){return e.form2.validate(function(e){return e?t(e):a(e)})});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,e)}))()},handleLookOver:function(){var e=this.addParams.splitTaskCode;e&&(this.RMsetPreviewTaskCode(e),this.RMsetPreview2(!0))}},R(["RMsetPreview2","RMsetPreviewTaskCode"]))},V={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form_other_run",attrs:{model:e.addParams,rules:e.rules,"label-width":"200px",size:e.formSize}},[a("el-form-item",{attrs:{prop:"splitTaskCode",label:"关联批次划分任务："}},[a("v-select",{attrs:{props:e.listProps,list:e.selectList,placeholder:"请选择批次划分任务名称",filterable:!0},model:{value:e.addParams.splitTaskCode,callback:function(t){e.$set(e.addParams,"splitTaskCode",t)},expression:"addParams.splitTaskCode"}}),e._v(" "),a("span",{staticClass:"look-over-btn pointer",on:{click:e.handleLookOver}},[e._v("查看")])],1),e._v(" "),a("el-form-item",{attrs:{prop:"appId",label:"场景名称："}},[a("v-select",{ref:"selectRef",attrs:{props:e.listProps,list:e.appids,placeholder:"请选择场景名称",filterable:!0},on:{appearEvent:e.changeAppName},model:{value:e.addParams.appId,callback:function(t){e.$set(e.addParams,"appId",t)},expression:"addParams.appId"}})],1)],1)},staticRenderFns:[]};var F=a("VU/8")(O,V,!1,function(e){a("MRoD")},"data-v-f00dbae0",null).exports,j={data:function(){return{btnSize:o.a.baseBtn,formSize:o.a.homeFormSize}},props:{pageFlag:{type:String,default:function(){return""}},addParams:{type:Object,default:function(){return{}}}},methods:{handleOk:function(){var e=this;return n()(s.a.mark(function t(){var a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,e.$refs.form_com._test();case 3:return a=null,"batchTasks"===e.pageFlag?a=e.$refs.form_other:"runManage"===e.pageFlag&&(a=e.$refs.form_other_run),t.next=7,a._test();case 7:e.$emit("ok",{step:"second",result:e.addParams});case 8:case"end":return t.stop()}},t,e)}))()},handleCancel:function(){this.$emit("cancel",{step:"second"})}},components:{FormCom:k,FormOther:D,FormOtherRun:F}},$={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"add-second-wrap"},[a("el-row",{staticClass:"content"},[a("el-col",{attrs:{span:12}},[a("form-com",{ref:"form_com",attrs:{addParams:e.addParams,pageFlag:e.pageFlag}})],1),e._v(" "),a("el-col",{attrs:{span:12}},["batchTasks"===e.pageFlag?a("form-other",{ref:"form_other",attrs:{addParams:e.addParams}}):e._e(),e._v(" "),"runManage"===e.pageFlag?a("form-other-run",{ref:"form_other_run",attrs:{addParams:e.addParams}}):e._e()],1)],1),e._v(" "),a("footer",{staticClass:"footer-wrap"},[a("el-button",{attrs:{size:e.btnSize},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{size:e.btnSize,type:"primary"},on:{click:e.handleOk}},[e._v("确定")])],1)],1)},staticRenderFns:[]};var N=a("VU/8")(j,$,!1,function(e){a("oAN4")},"data-v-66d1c796",null);t.default=N.exports},QNws:function(e,t,a){"use strict";t.a=function(e){var t=n.add;return Object(i.a)(t,{data:e,method:"post"})},t.b=function(e){var t=n.appids;return Object(i.a)(t,{data:e,method:"post"}).then(function(e){return e.data.forEach(function(e){e.appName||(e.appName="name"+e.appId)}),s.a.resolve(e)})},t.c=function(e){var t=n.execute;return Object(i.a)(t,{params:e,method:"post"})},t.d=function(e){var t=n.get;return Object(i.a)(t,{params:e,method:"post"})},t.e=function(e){var t=n.getShow;return Object(i.a)(t,{params:e,method:"post"})},t.f=function(e){var t=n.list;return Object(i.a)(t,{data:e,method:"post"})},t.g=function(e){var t=n.taskAll;return Object(i.a)(t,{params:e,method:"post"})},t.h=function(e){var t=n.update;return Object(i.a)(t,{data:e,method:"post"})};var r=a("//Fk"),s=a.n(r),i=a("68+Y"),n={add:"/task/schedule/add",appids:"/task/schedule/appids",execute:"/task/schedule/execute",get:"/task/schedule/get",getShow:"/task/schedule/get/show",list:"/task/schedule/list",taskAll:"/task/schedule/task/all",update:"/task/schedule/update"}},RU7c:function(e,t){},SVaQ:function(e,t,a){"use strict";var r=a("woOf"),s=a.n(r),i=a("QmSG"),n=a("aCdx"),o={data:function(){return{colWidth:"120px",dailyListParams:{offset:1,limit:i.a.limit,executeCode:"",taskCode:""},dailyList:[]}},props:{value:{type:Boolean,default:function(){return!1}}},mounted:function(){},methods:{handleDialogShow:function(e){var t=this;this.dailyListParams=s()({},this.dailyListParams,e),Object(n.c)(this.dailyListParams).then(function(e){t.dailyList=e.data.list})},handleClose:function(){this.$emit("closeDailyDialog")}},filters:{dateTimeDowith:function(e){return null===e||void 0===e?"":e.length>19?e.substr(0,19):e}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"daily-dialog",attrs:{title:"执行日志",visible:e.value,width:"537px"},on:{"update:visible":function(t){e.value=t},handleDialogShow:e.handleDialogShow,close:e.handleClose}},[a("section",[a("el-table",{staticClass:"m-t-20",attrs:{size:e.tableSize,data:e.dailyList,border:"","highlight-current-row":"",stripe:!0,height:"242",width:"100%"}},[a("el-table-column",{attrs:{label:"序号",type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":e.colWidth,"show-overflow-tooltip":"",prop:"optTime",label:"时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(e._f("dateTimeDowith")(t.row.optTime))+"\n                ")]}}])}),e._v(" "),a("el-table-column",{attrs:{"min-width":e.colWidth,"show-overflow-tooltip":"",prop:"optContent",label:"内容"}})],1)],1)])},staticRenderFns:[]};var c=a("VU/8")(o,l,!1,function(e){a("ravF")},"data-v-e1dd4b68",null);t.a=c.exports},a8wb:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("//Fk"),s=a.n(r),i=a("Xxa5"),n=a.n(i),o=a("exGp"),l=a.n(o),c=a("mvHQ"),d=a.n(c),u=a("woOf"),p=a.n(u),m=a("Dd8w"),f=a.n(m),h=a("SJI6"),g=a("k7T0"),v=Object(h.createNamespacedHelpers)("taskManage"),k=v.mapGetters,b=v.mapMutations,y={data:function(){return{addParams:{},addParamsTemp:{taskImpl:"",busiCode:"",conditionList:[],enable:"",remark:"",spiltNum:"",spiltStrip:"",spiltType:"",taskBeginTime:"",taskCode:"",taskCycleType:"",taskEndTime:"",taskName:"",taskParam:"",taskPriority:"1",taskTimeout:"",taskTriggerType:"",taskTypeCode:"",triggerDay:"",triggerHour:"",triggerMinute:"",triggerDate:"",triggerTime:"",triggerWeek:""}}},props:{pageFlag:{type:String,default:function(){return""}}},computed:f()({},k({addStep:"addStep",isEdit:"isEdit",taskCode:"taskCode",preview:"preview"})),created:function(){var e=this;this.isEdit&&Object(g.c)({taskCode:this.taskCode}).then(function(t){var a=t.data;e.addParams=a?p()({},a):JSON.parse(d()(e.addParamsTemp))})},methods:f()({cancelHandler:function(e){var t=this,a=e.step;switch(a){case"first":this._firstCancel().then(function(){t.setPage("home")});break;case"second":this._secondCancel().then(function(){t.setPage("home"),t.setAddStep(1)});break;default:return!1}},okHandler:function(e){var t=this,a=e.step,r=e.isAddTaskTemp,s=e.result;switch(a){case"first":this._firstOk(r,s).then(function(){t.setAddStep(2)});break;case"second":this._secondOk().then(function(){t.setPage("home"),t.setAddStep(1)});break;default:return!1}},_firstCancel:function(){var e=this;return l()(n.a.mark(function t(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},t,e)}))()},_firstOk:function(e,t){var a=this;return l()(n.a.mark(function r(){return n.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:a.addParams=e?p()({},t):JSON.parse(d()(a.addParamsTemp));case 3:case"end":return r.stop()}},r,a)}))()},_secondCancel:function(){var e=this;return l()(n.a.mark(function t(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},t,e)}))()},_secondOk:function(){var e=this;return l()(n.a.mark(function t(){var a,r;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isEdit){t.next=4;break}return a="此修改在下一次任务执行时生效，修改配置可能会造成与本任务关联的跑批任务场景变化, 如场景有变动请及时修改!",r="提示",t.abrupt("return",new s.a(function(t,s){e._$confirm({content:a,title:r}).then(function(){Object(g.h)(e.addParams).then(function(){t()})}).catch(function(){s()})}));case 4:return t.next=6,Object(g.a)(e.addParams).then(function(){});case 6:case"end":return t.stop()}},t,e)}))()}},b(["setAddStep","setPage"])),components:{AddFirst:function(){return new Promise(function(e){e()}).then(a.bind(null,"NZS0"))},AddSecond:function(){return new Promise(function(e){e()}).then(a.bind(null,"Pyrh"))},Detail:function(){return new Promise(function(e){e()}).then(a.bind(null,"h3h1"))}}},w={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"page h-fill"},[1===e.addStep?a("add-first",{staticClass:"h-fill",attrs:{pageFlag:e.pageFlag},on:{cancel:e.cancelHandler,ok:e.okHandler}}):a("add-second",{staticClass:"h-fill",attrs:{pageFlag:e.pageFlag,addParams:e.addParams},on:{cancel:e.cancelHandler,ok:e.okHandler}}),e._v(" "),e.preview?a("detail",{staticClass:"my-detail",attrs:{pageFlag:e.pageFlag}}):e._e()],1)},staticRenderFns:[]};var _=a("VU/8")(y,w,!1,function(e){a("y242")},"data-v-7f8ebc36",null);t.default=_.exports},aCdx:function(e,t,a){"use strict";t.b=function(e){var t=n.getCommonDict;return Object(i.a)(t,{params:e,method:"post"})},t.a=function(e){var t=n.getBusiCode;return Object(i.a)(t,{params:e,method:"post"}).then(function(e){return e.data=e.data.map(function(e){return"string"==typeof e&&(e={busiName:"name"+e,busiCode:e}),e}),s.a.resolve(e)})},t.e=function(e){var t=n.getNumByBusiCode;return Object(i.a)(t,{params:e,method:"post",timeout:2e5,loading:!1})},t.d=function(e){var t=n.getMoreRecordList;return Object(i.a)(t,{data:e,method:"post",transformRequest:[function(e){var t="";for(var a in e)t+=encodeURIComponent(a)+"="+encodeURIComponent(e[a])+"&";return t}]})},t.c=function(e){var t=n.getDailyList;return Object(i.a)(t,{data:e,method:"post"})};var r=a("//Fk"),s=a.n(r),i=a("68+Y"),n={getCommonDict:"/common/commonSelect",getBusiCode:"/business/code/list",getNumByBusiCode:"/business/detail/num",getMoreRecordList:"/bttasklog/execute/list",getDailyList:"/bttasklog/list"}},b9ge:function(e,t){},h3h1:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Xxa5"),s=a.n(r),i=a("exGp"),n=a.n(i),o=a("woOf"),l=a.n(o),c=a("Dd8w"),d=a.n(c),u=a("QmSG"),p=a("SJI6"),m=a("k7T0"),f=a("QNws"),h=a("4v6z"),g=a("Q0Ca"),v=a("SVaQ"),k=(a("pFYg"),a("aCdx")),b={data:function(){return{tableSize:u.a.tableSize,colWidth:"200px",labelWidth:"120px",total:0,moreRecordParams:{offset:1,limit:u.a.limit,taskCode:""},moreRecordList:[]}},props:{value:{type:Boolean,default:function(){return!1}}},mounted:function(){},filters:{formatTaskStatus:function(e){return{1:"未执行",2:"执行中",3:"执行暂停",4:"执行终止",5:"执行完成"}[e]}},methods:{clickShow:function(e,t){var a=this.moreRecordList[e];a.showTable=!t,this.moreRecordList.splice(e,1,a)},_getMoreRecordList:function(){var e=this;Object(k.d)(this.moreRecordParams).then(function(t){e.total=t.data.total;var a=t.data.list.map(function(e,t){return e.showTable=!1,e.index=t,e});e.moreRecordList=a})},handleDialogShow:function(e){this.moreRecordParams=l()({},this.moreRecordParams,e),this._getMoreRecordList(this.moreRecordParams)},handlePagingChange:function(e){this.moreRecordParams=l()({},this.moreRecordParams,e),this._getMoreRecordList(this.moreRecordParams)},handleClose:function(){this.$emit("moreReDialog")}}},y={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"more-record-dialog page",attrs:{title:"查看更多执行记录",visible:e.value,width:"850px"},on:{"update:visible":function(t){e.value=t},handleDialogShow:e.handleDialogShow,close:e.handleClose}},[a("section",[e.moreRecordList.length?e._e():a("div",{staticClass:"empty-data"},[e._v("\n            暂无数据\n        ")]),e._v(" "),a("ul",{staticClass:"list-wrap"},e._l(e.moreRecordList,function(t){return a("li",{directives:[{name:"show",rawName:"v-show",value:e.moreRecordList.length,expression:"moreRecordList.length"}],key:t.executeCode},[a("el-row",[a("el-col",{attrs:{span:8}},[a("v-item-detail",{attrs:{border:!1,pxUnit:!0,labelWidth:e.labelWidth,label:"执行开始时间：",span:e.span}},[a("span",{staticClass:"block text-ellipsis"},[e._v(e._s(e._f("formatTime")(t.taskBeginTime,"yyyy-MM-dd hh:mm:ss")))])])],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("v-item-detail",{staticClass:"m-t-34",attrs:{border:!1,pxUnit:!0,labelWidth:e.labelWidth,label:"执行开结束时间：",span:e.span}},[a("span",{staticClass:"block text-ellipsis"},[e._v(e._s(e._f("formatTime")(t.taskEndTime,"yyyy-MM-dd hh:mm:ss")))])])],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("v-item-detail",{staticClass:"m-t-34",attrs:{border:!1,pxUnit:!0,labelWidth:e.labelWidth,label:"任务执行结果：",span:e.span}},[a("span",{staticClass:"block text-ellipsis"},[e._v(e._s(e._f("formatTaskStatus")(t.executeStatus)))])])],1),e._v(" "),a("el-col",{staticClass:"m-t-8",attrs:{span:2}},[a("div",{on:{click:function(a){return e.clickShow(t.index,t.showTable)}}},[a("i",{staticClass:"font-12 icon",class:t.showTable?"el-icon-arrow-up":"el-icon-arrow-down"})])])],1),e._v(" "),t.showTable?a("el-table",{staticClass:"table-wrap",attrs:{size:e.tableSize,data:t.logs,border:"","highlight-current-row":"",stripe:!0}},[a("el-table-column",{attrs:{label:"序号",type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":e.colWidth,"show-overflow-tooltip":"",prop:"creatTime",label:"时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                                "+e._s(e._f("formatTime")(t.row.creatTime,"yyyy-MM-dd hh:mm:ss"))+"\n                            ")]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{"min-width":e.colWidth,"show-overflow-tooltip":"",prop:"descr",label:"内容"}})],1):e._e()],1)}),0),e._v(" "),e.moreRecordList.length?a("v-paging",{ref:"rPages",attrs:{total:e.total},on:{pagingChange:e.handlePagingChange}}):e._e()],1)])},staticRenderFns:[]};var w=a("VU/8")(b,y,!1,function(e){a("b9ge")},"data-v-50225691",null).exports,_=Object(p.createNamespacedHelpers)("taskManage"),C=_.mapMutations,T=_.mapGetters,P={data:function(){return{taskName:"",labelWidth:200,btnSize:u.a.homeBtn,executeCode:"",detailData:[],runResult:[],dialogVisible:!1,moreRecordDialogVisible:!1}},computed:d()({},T(["taskCode","RMtaskCode","preview","RMpreview","RMpreview2","RMpreviewTaskCode","taskCycleTypeDict","searchCodeDict","conditionTypeDict","relationDict"]),{pageType:function(){return"batchTasks"===this.pageFlag?1:2},routerQuery:function(){var e={type:this.pageType,taskName:this.taskName,executeCode:this.executeCode};return"batchTasks"===this.pageFlag?e=l()({},e,{taskCode:this.RMpreview2?this.RMpreviewTaskCode:this.taskCode}):"runManage"===this.pageFlag&&(e=l()({},e,{taskCode:this.RMtaskCode})),e}}),props:{pageFlag:{type:String,default:function(){return""}}},created:function(){"batchTasks"===this.pageFlag?this._getBatchTasksDetail():"runManage"===this.pageFlag&&this._getRunManageDetail()},methods:d()({_getBatchTasksDetail:function(){var e=this;return n()(s.a.mark(function t(){var a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(m.e)({taskCode:e.RMpreview2?e.RMpreviewTaskCode:e.taskCode});case 2:a=t.sent,e.executeCode=a.data.executeCode,e.detailData=[{label:"任务名称：",value:a.data.taskName},{label:"任务备注：",value:a.data.remark},{label:"任务参数设定：",value:a.data.taskParam},{label:"任务启动日期：",value:Object(g.formatTime)(a.data.taskBeginTime,"yyyy-MM-dd")},{label:"任务终止日期：",value:Object(g.formatTime)(a.data.taskEndTime,"yyyy-MM-dd")},{label:"任务周期类型：",value:e._formatTaskCycleType(a.data)},{label:"任务周期描述：",value:e._formatTaskCycleDesc(a.data)},{label:"任务优先级：",value:a.data.taskPriority},{label:"业务名称：",value:a.data.busiName||"name"+a.data.busiCode},{label:"数据总条数：",value:a.data.totalNum},{label:"批次拆分：",value:"共拆分"+e._formatSpiltType(a.data)},{label:"数据选择条件：",value:e._formatCondition(a.data)}],e.runResult=[{label:"执行开始时间：",value:Object(g.formatTime)(a.data.lastBeginTime,"yyyy-MM-dd hh:mm:ss")},{label:"执行结束时间：",value:Object(g.formatTime)(a.data.lastEndTime,"yyyy-MM-dd hh:mm:ss")},{label:"执行结果：",value:a.data.executeResult},{label:"执行日志",flag:!0,list:["查看日志"]}];case 6:case"end":return t.stop()}},t,e)}))()},_getRunManageDetail:function(){var e=this;return n()(s.a.mark(function t(){var a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(f.e)({taskCode:e.RMtaskCode});case 2:a=t.sent,e.taskName=a.data.taskName,e.executeCode=a.data.executeCode,e.detailData=[{label:"任务名称：",value:a.data.taskName},{label:"任务备注：",value:a.data.remark},{label:"任务参数设定：",value:a.data.taskParam},{label:"任务启动日期：",value:Object(g.formatTime)(a.data.taskBeginTime,"yyyy-MM-dd")},{label:"任务终止日期：",value:Object(g.formatTime)(a.data.taskEndTime,"yyyy-MM-dd")},{label:"任务周期类型：",value:e._formatTaskCycleType(a.data)},{label:"任务周期描述：",value:e._formatTaskCycleDesc(a.data)},{label:"任务优先级：",value:a.data.taskPriority}],e.runResult=[{label:"执行开始时间：",value:Object(g.formatTime)(a.data.lastBeginTime,"yyyy-MM-dd hh:mm:ss")},{label:"执行结束时间：",value:Object(g.formatTime)(a.data.lastEndTime,"yyyy-MM-dd hh:mm:ss")},{label:"执行结果：",value:a.data.executeResult},{label:"执行日志",flag:!0,list:["查看日志"]},{label:"总条数：",value:a.data.totalNum},{label:"已执行：",value:a.data.executeNum},{label:"关联批次划分任务：",value:a.data.splitTaskName},{label:"场景名称：",value:a.data.appName||"name"+a.data.appId}];case 7:case"end":return t.stop()}},t,e)}))()},handleViewLog:function(e,t,a,r){switch(r){case 1:this._goViewLog();break;default:return!1}},handleViewAllLog:function(e){switch(e){case 1:this._goViewAllLog();break;case 2:this._goViewTaskWatch();break;default:return!1}},_goViewLog:function(){this.$refs.dailyRecordDialog.handleDialogShow(this.routerQuery),this.dialogVisible=!0},closeDailyDialog:function(){this.dialogVisible=!1},_goViewAllLog:function(){this.$refs.moreRecordDialog.handleDialogShow(this.routerQuery),this.moreRecordDialogVisible=!0},moreReDialog:function(){this.moreRecordDialogVisible=!1},_goViewTaskWatch:function(){this.$router.push({path:"/watchManage/taskWatch",query:this.routerQuery})},handleBack:function(e){1===e?"batchTasks"===this.pageFlag?this.setPage("home"):"runManage"===this.pageFlag&&this.RMsetPage("home"):2===e?this.setPreview(!1):3===e&&(this.RMsetPreview(!1),this.RMsetPreview2(!1))},_formatTaskCycleType:function(e){var t=e.taskCycleType,a=this.taskCycleTypeDict.find(function(e){return parseInt(e.keyValue)===parseInt(t)});return a&&a.keyName},_formatSearchCodeDict:function(e){var t=this.searchCodeDict.find(function(t){return parseInt(t.keyValue)===parseInt(e)});return t&&t.keyName},_formatConditionTypeDict:function(e){var t=this.conditionTypeDict.find(function(t){return parseInt(t.keyValue)===parseInt(e)});return t&&t.keyName},_formatRelationDict:function(e){var t=this.relationDict.find(function(t){return parseInt(t.keyValue)===parseInt(e)});return t&&t.keyName},_formatTaskCycleDesc:function(e){var t=e.taskCycleType,a=e.triggerDate;return 3===parseInt(t)?"":1===parseInt(t)?""+Object(h.a)(Number(a),"yyyy-MM-dd hh:mm:ss"):""+this._fn(e)},_fn:function(e){var t=e.taskTriggerType,a=e.triggerDay,r=e.triggerTime,s=e.triggerWeek,i=e.triggerHour,n=e.triggerMinute;switch(parseInt(t)){case 1:return"每月"+a+"日 "+r;case 2:return"每2星期"+s+" "+r;case 3:return"每星期"+s+" "+r;case 4:return"每天"+r;case 5:return"每隔"+i+"小时";case 6:return"每隔"+n+"分钟";default:return""}},_formatCondition:function(e){var t=this,a=e.conditionList;if(Array.isArray(a)){var r=[];return a.forEach(function(e){var a=e.searchCode,s=e.conditionType,i=e.relation,n=e.searchVal1,o=e.searchVal2,l="",c=t._formatSearchCodeDict(a),d=t._formatConditionTypeDict(s),u=t._formatRelationDict(i);l+=c+" "+d+" "+n,o&&(l+="-"+o),l+=" "+u,r.push(l)}),r.join(";")}},_formatBeginHandle:function(e){return["","全部清空","部分清空","不清除"][e.beginHandle]},_formatErrorHandle:function(e){return["","终止并清空","终止并保留","不终止"][e.errorHandle]},_formatSpiltType:function(e){var t=e.spiltType,a=e.spiltNum,r=e.spiltStrip;return 1===Number(t)?a+"批次拆分":r+"条病例/批次"}},C({setPage:"setPage",RMsetPage:"RMsetPage",setPreview:"setPreview",RMsetPreview:"RMsetPreview",RMsetPreview2:"RMsetPreview2"})),components:{DailyRecordDialog:v.a,MoreRecordDialog:w}},x={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"h-fill wrap"},[a("el-row",[a("el-col",{attrs:{span:"12"}},[a("div",{staticClass:"title"}),e._v(" "),e._l(e.detailData,function(t,r){return a("div",{key:r},[t.flag?e._e():a("v-item-detail",{attrs:{tooltip:!0,label:t.label,pxUnit:!0,labelWidth:e.labelWidth}},[a("span",{staticClass:"block text-ellipsis"},[e._v(e._s(t.value))]),e._v(" "),a("div",{staticClass:"tooltip-item",attrs:{slot:"content"},slot:"content"},[e._v(e._s(t.value))])]),e._v(" "),t.flag?a("v-item-detail",{attrs:{label:t.label,pxUnit:!0,labelWidth:e.labelWidth,border:!1}},[a("div",e._l(t.list,function(t,r){return a("span",{key:r,staticClass:"block list",class:{mt:r}},[e._v("\n                            "+e._s(t.value)+"\n                        ")])}),0)]):e._e()],1)})],2),e._v(" "),a("el-col",{attrs:{span:"12"}},[a("div",{staticClass:"title"},[e._v("最近一次任务执行结果")]),e._v(" "),e._l(e.runResult,function(t,r){return a("div",{key:r},[t.flag?e._e():a("v-item-detail",{attrs:{label:t.label,pxUnit:!0,labelWidth:e.labelWidth}},[a("span",{staticClass:"block text-ellipsis"},[e._v(e._s(t.value))])]),e._v(" "),t.flag?a("v-item-detail",{attrs:{label:t.label,pxUnit:!0,labelWidth:e.labelWidth}},[a("div",e._l(t.list,function(s,i){return a("span",{key:i,staticClass:"inner-block text-ellipsis",class:{active:t.flag},staticStyle:{"margin-right":"20px"},on:{click:function(a){return e.handleViewLog(t,r+1,s,i+1)}}},[e._v("\n                            "+e._s(s)+"\n                        ")])}),0)]):e._e()],1)}),e._v(" "),a("v-item-detail",{attrs:{label:" ",pxUnit:!0,labelWidth:e.labelWidth,border:!1}},[a("span",{staticClass:"inner-block text-ellipsis"},[a("el-button",{attrs:{size:e.btnSize},on:{click:function(t){return e.handleViewAllLog(1)}}},[e._v("查看更多执行记录")])],1),e._v(" "),"runManage"===e.pageFlag?a("span",{staticClass:"inner-block text-ellipsis"},[a("el-button",{attrs:{size:e.btnSize},on:{click:function(t){return e.handleViewAllLog(2)}}},[e._v("查看任务监控")])],1):e._e()])],2)],1),e._v(" "),a("div",{staticStyle:{"text-align":"center","padding-top":"65px","padding-bottom":"30px"}},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.preview&&!e.RMpreview&&!e.RMpreview2,expression:"!preview && !RMpreview && !RMpreview2"}],attrs:{size:e.btnSize,type:"primary"},on:{click:function(t){return e.handleBack(1)}}},[e._v("返回")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.preview,expression:"preview"}],attrs:{size:e.btnSize,type:"primary"},on:{click:function(t){return e.handleBack(2)}}},[e._v("返回")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.RMpreview||e.RMpreview2,expression:"RMpreview || RMpreview2"}],attrs:{size:e.btnSize,type:"primary"},on:{click:function(t){return e.handleBack(3)}}},[e._v("返回")])],1),e._v(" "),a("daily-record-dialog",{ref:"dailyRecordDialog",on:{closeDailyDialog:e.closeDailyDialog},model:{value:e.dialogVisible,callback:function(t){e.dialogVisible=t},expression:"dialogVisible"}}),e._v(" "),a("more-record-dialog",{ref:"moreRecordDialog",on:{moreReDialog:e.moreReDialog},model:{value:e.moreRecordDialogVisible,callback:function(t){e.moreRecordDialogVisible=t},expression:"moreRecordDialogVisible"}})],1)},staticRenderFns:[]};var S=a("VU/8")(P,x,!1,function(e){a("pTE2")},"data-v-57864d1e",null);t.default=S.exports},iwby:function(e,t){},jFJA:function(e,t){},k7T0:function(e,t,a){"use strict";t.a=function(e){var t=s.add;return Object(r.a)(t,{data:e,method:"post"})},t.b=function(e){var t=s.execute;return Object(r.a)(t,{params:e,method:"post"})},t.c=function(e){var t=s.get;return Object(r.a)(t,{params:e,method:"post"})},t.e=function(e){var t=s.getShow;return Object(r.a)(t,{params:e,method:"post"})},t.f=function(e){var t=s.list;return Object(r.a)(t,{data:e,method:"post"})},t.g=function(e){var t=s.taskAll;return Object(r.a)(t,{params:e,method:"post"})},t.h=function(e){var t=s.update;return Object(r.a)(t,{data:e,method:"post"})},t.d=function(e){var t=s.getInfoByBusiCode;return Object(r.a)(t,{params:e,method:"post"})};var r=a("68+Y"),s={add:"/task/split/add",execute:"/task/split/execute",get:"/task/split/get",getShow:"/task/split/get/show",list:"/task/split/list",taskAll:"/task/split/task/all",update:"/task/split/update",getInfoByBusiCode:"/business/get"}},kBs6:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("//Fk"),s=a.n(r),i=a("Xxa5"),n=a.n(i),o=a("exGp"),l=a.n(o),c=a("mvHQ"),d=a.n(c),u=a("woOf"),p=a.n(u),m=a("Dd8w"),f=a.n(m),h=a("SJI6"),g=a("QNws"),v=Object(h.createNamespacedHelpers)("taskManage"),k=v.mapGetters,b=v.mapMutations,y={data:function(){return{addParams:{},addParamsTemp:{taskImpl:"",appId:"",beginHandle:"",enable:"",errorHandle:"",remark:"",splitTaskCode:"",taskBeginTime:"",taskCode:"",taskCycleType:"",taskEndTime:"",taskName:"",taskParam:"",taskPriority:"1",taskTimeout:"",taskTriggerType:"",taskTypeCode:"",triggerDate:"",triggerDay:"",triggerHour:"",triggerMinute:"",triggerTime:"",triggerWeek:""}}},props:{pageFlag:{type:String,default:function(){return""}}},computed:f()({},k({addStep:"RMaddStep",isEdit:"RMisEdit",taskCode:"RMtaskCode",RMpreview:"RMpreview",RMpreview2:"RMpreview2"})),created:function(){var e=this;this.isEdit&&Object(g.d)({taskCode:this.taskCode}).then(function(t){var a=t.data;e.addParams=a?p()({},a):JSON.parse(d()(e.addParamsTemp))})},methods:f()({cancelHandler:function(e){var t=this,a=e.step;switch(a){case"first":this._firstCancel().then(function(){t.RMsetPage("home")});break;case"second":this._secondCancel().then(function(){t.RMsetPage("home"),t.RMsetAddStep(1)});break;default:return!1}},okHandler:function(e){var t=this,a=e.step,r=e.isAddTaskTemp,s=e.result;switch(a){case"first":this._firstOk(r,s).then(function(){t.RMsetAddStep(2)});break;case"second":this._secondOk().then(function(){t.RMsetPage("home"),t.RMsetAddStep(1)});break;default:return!1}},_firstCancel:function(){var e=this;return l()(n.a.mark(function t(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},t,e)}))()},_firstOk:function(e,t){var a=this;return l()(n.a.mark(function r(){return n.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:a.addParams=e?p()({},t):JSON.parse(d()(a.addParamsTemp));case 3:case"end":return r.stop()}},r,a)}))()},_secondCancel:function(){var e=this;return l()(n.a.mark(function t(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},t,e)}))()},_secondOk:function(){var e=this;return l()(n.a.mark(function t(){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isEdit){t.next=2;break}return t.abrupt("return",new s.a(function(t,a){Object(g.h)(e.addParams).then(function(){t()})}));case 2:return t.next=4,Object(g.a)(e.addParams).then(function(){});case 4:case"end":return t.stop()}},t,e)}))()}},b(["RMsetAddStep","RMsetPage","setTaskCode","RMsetPreview"])),components:{AddFirst:function(){return new Promise(function(e){e()}).then(a.bind(null,"NZS0"))},AddSecond:function(){return new Promise(function(e){e()}).then(a.bind(null,"Pyrh"))},Detail:function(){return new Promise(function(e){e()}).then(a.bind(null,"h3h1"))}}},w={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"page h-fill"},[1===e.addStep?a("add-first",{staticClass:"h-fill",attrs:{pageFlag:e.pageFlag},on:{cancel:e.cancelHandler,ok:e.okHandler}}):a("add-second",{staticClass:"h-fill",attrs:{pageFlag:e.pageFlag,addParams:e.addParams},on:{cancel:e.cancelHandler,ok:e.okHandler}}),e._v(" "),e.RMpreview?a("detail",{staticClass:"my-detail",attrs:{pageFlag:"runManage"}}):e._e(),e._v(" "),e.RMpreview2?a("detail",{staticClass:"my-detail",attrs:{pageFlag:"batchTasks"}}):e._e()],1)},staticRenderFns:[]};var _=a("VU/8")(y,w,!1,function(e){a("iwby")},"data-v-5c36d566",null);t.default=_.exports},oAN4:function(e,t){},oX5D:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Dd8w"),s=a.n(r),i=a("SJI6"),n=a("aCdx"),o=Object(i.createNamespacedHelpers)("taskManage"),l=o.mapState,c=o.mapMutations,d={data:function(){return{pageFlag:"batchTasks"}},computed:s()({},l({page:function(e){return e.page},isInit:function(e){return e.isInit}})),created:function(){var e=this;this.isInit||(Object(n.b)({type:"1;2;3;4;5;6"}).then(function(t){var a=t.data.dicts;e.setDicts({key:"taskTypeDict",dict:a[1]}),e.setDicts({key:"taskCycleTypeDict",dict:a[2]}),e.setDicts({key:"taskPriorityDict",dict:a[3]}),e.setDicts({key:"searchCodeDict",dict:a[4]}),e.setDicts({key:"conditionTypeDict",dict:a[5]}),e.setDicts({key:"relationDict",dict:a[6]})}),Object(n.a)({enable:0}).then(function(t){e.setDicts({key:"busiCodeDict",dict:t.data})}),this.setIsInit(!0)),this.setPage(),this.setAddStep(),this.setPreview()},mounted:function(){},methods:s()({},c({setPage:"setPage",setAddStep:"setAddStep",setIsInit:"setIsInit",setDicts:"setDicts",setPreview:"setPreview"})),components:{ListWrap:function(){return new Promise(function(e){e()}).then(a.bind(null,"PBxX"))},Detail:function(){return new Promise(function(e){e()}).then(a.bind(null,"h3h1"))},AddWrap:function(){return new Promise(function(e){e()}).then(a.bind(null,"a8wb"))}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",["home"===e.page?a("List-wrap",{attrs:{pageFlag:e.pageFlag}}):e._e(),e._v(" "),"detail"===e.page?a("detail",{attrs:{pageFlag:e.pageFlag}}):e._e(),e._v(" "),"add"===e.page?a("add-wrap",{attrs:{pageFlag:e.pageFlag}}):e._e()],1)},staticRenderFns:[]},p=a("VU/8")(d,u,!1,null,null,null);t.default=p.exports},pTE2:function(e,t){},qDGr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Dd8w"),s=a.n(r),i=a("SJI6"),n=a("aCdx"),o=Object(i.createNamespacedHelpers)("taskManage"),l=o.mapState,c=o.mapMutations,d={data:function(){return{pageFlag:"runManage"}},computed:s()({},l({page:function(e){return e.RMpage},isInit:function(e){return e.isInit}})),created:function(){var e=this;this.isInit||(Object(n.b)({type:"1;2;3;4;5;6"}).then(function(t){var a=t.data.dicts;e.setDicts({key:"taskTypeDict",dict:a[1]}),e.setDicts({key:"taskCycleTypeDict",dict:a[2]}),e.setDicts({key:"taskPriorityDict",dict:a[3]}),e.setDicts({key:"searchCodeDict",dict:a[4]}),e.setDicts({key:"conditionTypeDict",dict:a[5]}),e.setDicts({key:"relationDict",dict:a[6]})}),Object(n.a)({enable:0}).then(function(t){e.setDicts({key:"busiCodeDict",dict:t.data})}),this.setIsInit(!0)),this.RMsetPage(),this.RMsetAddStep(),this.RMsetPreview(!1),this.RMsetPreview2(!1)},mounted:function(){},methods:s()({},c({RMsetPage:"RMsetPage",RMsetAddStep:"RMsetAddStep",setIsInit:"setIsInit",setDicts:"setDicts",RMsetPreview:"RMsetPreview",RMsetPreview2:"RMsetPreview2"})),components:{ListWrap:function(){return new Promise(function(e){e()}).then(a.bind(null,"Omrf"))},Detail:function(){return new Promise(function(e){e()}).then(a.bind(null,"h3h1"))},AddWrap:function(){return new Promise(function(e){e()}).then(a.bind(null,"kBs6"))}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",["home"===e.page?a("List-wrap",{attrs:{pageFlag:e.pageFlag}}):e._e(),e._v(" "),"detail"===e.page?a("detail",{attrs:{pageFlag:e.pageFlag}}):e._e(),e._v(" "),"add"===e.page?a("add-wrap",{attrs:{pageFlag:e.pageFlag}}):e._e()],1)},staticRenderFns:[]},p=a("VU/8")(d,u,!1,null,null,null);t.default=p.exports},ravF:function(e,t){},vLmQ:function(e,t,a){"use strict";var r=a("QmSG"),s=a("4v6z"),i={props:{operationWidth:{type:Number,default:function(){return 480}},pageFlag:{type:String,default:function(){return""}},tableData:{type:Array,default:function(){return[]}},goOnShow:{type:Boolean,default:function(){return!1}},exitShow:{type:Boolean,function:function(){return!1}},suspendShow:{type:Boolean,default:function(){return!1}},viewLogShow:{type:Boolean,default:function(){return!1}},viewTaskShow:{type:Boolean,default:function(){return!1}},resultPreShow:{type:Boolean,default:function(){return!1}},priorityList:{type:Array,default:function(){return[]}}},data:function(){return{tableSize:r.a.tableSize,colWidth:"100px",options:[{value:"0",label:"禁用"},{value:"1",label:"启用"}]}},methods:{handleEdit:function(e){this.$emit("edit",e)},handleLook:function(e){this.$emit("look",e)},handleCommand:function(e,t){var a=this;if(e.enable===t.value)return!1;if("1"===t.value)this.$emit("command",{row:e,item:t});else{var r=e.enable;e.enable=t.value,this._$confirm({content:"是否确定禁用该任务",title:"提示"}).then(function(){a.$emit("command",{row:e,item:t})}).catch(function(){return e.enable=r,!1})}},handlePriority:function(e,t){var a=this;if(parseInt(e.taskPriority)===parseInt(t.value))return!1;this._$confirm({content:"是否修改任务优先级",title:"提示"}).then(function(){a.$emit("priority",{row:e,item:t})}).catch(function(){return!1})},handleRun:function(e){var t=this;this._$confirm({content:"是否立即执行任务",title:"提示"}).then(function(){t.$emit("run",e)}).catch(function(){return!1})},handleGoOn:function(e){var t=this;this._$confirm({content:"是否继续此任务",title:"提示"}).then(function(){t.$emit("goOn",e)}).catch(function(){return!1})},handleSuspend:function(e){var t=this;this._$confirm({content:"是否暂停此任务",title:"提示"}).then(function(){t.$emit("suspend",e)}).catch(function(){return!1})},handleExit:function(e){var t=this;this._$confirm({content:"是否终止此任务",title:"提示"}).then(function(){t.$emit("exit",e)}).catch(function(){return!1})},handleResultPre:function(e){var t=this;if(e.enable+""=="0")return!1;this._$confirm({content:"是否立即重跑前一次任务，之前跑批结果将被清空",title:"提示"}).then(function(){t.$emit("resultPre",e)}).catch(function(){return!1})},handleViewLog:function(e){this.$emit("viewLog",e)},handleViewTask:function(e){this.$emit("viewTask",e)},_editBtnShow:function(e,t){return"batchTasks"!==this.pageFlag||!("1"===e&&"2"===t||"1"===e&&"5"===t||"3"===e&&"2"===t||"3"===e&&"5"===t)},_resultPreShow:function(e){return e+""!="0"},_runBtnShow:function(e,t,a){if(a+""=="0")return!1;if("runManage"===this.pageFlag){if("2"===e&&"2"===t||"1"===e&&"2"===t||"1"===e&&"5"===t||"3"===e&&"2"===t||"4"===t||"3"===t||"3"===e&&"5"===t)return!1}else if("1"===e&&"2"===t||"1"===e&&"5"===t||"3"===e&&"2"===t||"3"===e&&"5"===t)return!1;return!0},_goOnBtnShow:function(e,t,a){if(a+""=="0")return!1;return"2"===e&&"3"===t||"1"===e&&"3"===t||"3"===e&&"3"===t},_suspendBtnShow:function(e,t,a){if(a+""=="0")return!1;return"2"===e&&"2"===t||"1"===e&&"2"===t||"3"===e&&"2"===t},_exitBtnShow:function(e,t,a){if(a+""=="0")return!1;return"2"===e&&"2"===t||"1"===e&&"2"===t||"3"===e&&"2"===t},_formatLastTaskStatus:function(e){var t=e.lastTaskStatus;e.enable;return{1:"未执行",2:"执行中",3:"执行暂停",4:"执行终止",5:"执行完成"}[t]}},filters:{formatEnable:function(e){return"0"===e?"禁用":"启用"},beginTime:function(e){if(e.taskCycleType){if(3===parseInt(e.taskCycleType))return""+Object(s.a)(Number(e.lastBeginTime),"yyyy-MM-dd hh:mm:ss");if(1===parseInt(e.taskCycleType))return e.triggerDate?""+Object(s.a)(Number(e.triggerDate),"yyyy-MM-dd hh:mm:ss"):""+Object(s.a)(Number(e.taskBeginTime),"yyyy-MM-dd hh:mm:ss");if(2===parseInt(e.taskCycleType)){var t={1:"日",2:"一",3:"二",4:"三",5:"四",6:"五",7:"六"}[e.triggerWeek+""];return 1===e.taskTriggerType?"每月"+e.triggerDay+" "+e.triggerTime:2===e.taskTriggerType?"每2星期"+t+" "+e.triggerTime:3===e.taskTriggerType?"每星期"+t+" "+e.triggerTime:4===e.taskTriggerType?"每天"+e.triggerTime:5===e.taskTriggerType?"每隔"+e.triggerHour+"小时":6===e.taskTriggerType?"每隔"+e.triggerMinute+"分钟":""+Object(s.a)(Number(e.taskBeginTime),"yyyy-MM-dd hh:mm:ss")}}}},components:{}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-table",{attrs:{size:e.tableSize,data:e.tableData,"highlight-current-row":"",stripe:!0,height:"100%",width:"100%",border:""}},[a("el-table-column",{attrs:{label:"序号",type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":e.colWidth,"show-overflow-tooltip":"",prop:"taskName",label:"任务名称"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":e.colWidth,"show-overflow-tooltip":"",prop:"taskBeginTime",label:"执行时间描述"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("beginTime")(t.row)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{"min-width":"150px","show-overflow-tooltip":"",prop:"lastBeginTime",label:"最近一次执行开始时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("formatTime")(t.row.lastBeginTime,"yyyy-MM-dd hh:mm:ss")))])]}}])}),e._v(" "),a("el-table-column",{attrs:{"min-width":"150px","show-overflow-tooltip":"",prop:"lastEndTime",label:"最近一次执行结束时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("formatTime")(t.row.lastEndTime,"yyyy-MM-dd hh:mm:ss")))])]}}])}),e._v(" "),a("el-table-column",{attrs:{"min-width":"150px","show-overflow-tooltip":"",prop:"lastTaskStatus",label:"最近一次执行状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e._formatLastTaskStatus(t.row))+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{"min-width":e.colWidth,label:"任务优先级",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-dropdown",{staticClass:"pointer",attrs:{trigger:"click"}},[a("span",{staticClass:"el-dropdown-link"},[e._v("\n                    "+e._s(t.row.taskPriority)+"\n                "),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.priorityList,function(r){return a("el-dropdown-item",{key:r.value,nativeOn:{click:function(a){return e.handlePriority(t.row,r)}}},[e._v(e._s(r.label)+"\n                    ")])}),1)],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{"min-width":e.colWidth,label:"任务状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-dropdown",{staticClass:"pointer",attrs:{trigger:"click"}},[a("span",{staticClass:"el-dropdown-link"},[e._v("\n                    "+e._s(e._f("formatEnable")(t.row.enable))+"\n                "),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.options,function(r){return a("el-dropdown-item",{key:r.value,nativeOn:{click:function(a){return e.handleCommand(t.row,r)}}},[e._v(e._s(r.label)+"\n                    ")])}),1)],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:e.operationWidth},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"edit-btn-class",attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleLook(t.row)}}},[e._v("查看\n            ")]),e._v(" "),e.viewLogShow?a("el-button",{staticClass:"edit-btn-class",attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleViewLog(t.row)}}},[e._v("查看日志\n            ")]):e._e(),e._v(" "),e.viewTaskShow?a("el-button",{staticClass:"edit-btn-class",attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleViewTask(t.row)}}},[e._v("查看任务监控\n            ")]):e._e(),e._v(" "),e._editBtnShow(t.row.taskCycleType,t.row.lastTaskStatus,t.row)?a("el-button",{staticClass:"edit-btn-class",attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleEdit(t.row)}}},[e._v("编辑\n            ")]):e._e(),e._v(" "),e._runBtnShow(t.row.taskCycleType,t.row.lastTaskStatus,t.row.enable)?a("el-button",{staticClass:"edit-btn-class",attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleRun(t.row)}}},[e._v("立即执行\n            ")]):e._e(),e._v(" "),e.goOnShow&&e._goOnBtnShow(t.row.taskCycleType,t.row.lastTaskStatus,t.row.enable)?a("el-button",{staticClass:"edit-btn-class",attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleGoOn(t.row)}}},[e._v("继续\n            ")]):e._e(),e._v(" "),e.suspendShow&&e._suspendBtnShow(t.row.taskCycleType,t.row.lastTaskStatus,t.row.enable)?a("el-button",{staticClass:"edit-btn-class",attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleSuspend(t.row)}}},[e._v("暂停\n            ")]):e._e(),e._v(" "),e.exitShow&&e._exitBtnShow(t.row.taskCycleType,t.row.lastTaskStatus,t.row.enable)?a("el-button",{staticClass:"edit-btn-class",attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleExit(t.row)}}},[e._v("终止\n            ")]):e._e(),e._v(" "),e.resultPreShow&&e._resultPreShow(t.row.enable)?a("el-button",{staticClass:"edit-btn-class",attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleResultPre(t.row)}}},[e._v("重跑前次任务\n            ")]):e._e()]}}])})],1)},staticRenderFns:[]};var o=a("VU/8")(i,n,!1,function(e){a("9gKN")},"data-v-5c0957f8",null);t.a=o.exports},vv6e:function(e,t){},y242:function(e,t){}});